<html><head><meta http-equiv="content-type" content="text/html; charset=UTF-8"><title>Conversation with #nixos at Thu 01 Jan 2015 09:10:55 PM CET on magnetophon@irc.freenode.net (irc)</title></head><body><h3>Conversation with #nixos at Thu 01 Jan 2015 09:10:55 PM CET on magnetophon@irc.freenode.net (irc)</h3>
<font size="2">(09:10:55 PM)</font><b> The topic for #nixos is: <a href="http://nixos.org/">http://nixos.org/</a> || Latest NixOS: <a href="http://nixos.org/nixos/download.html">http://nixos.org/nixos/download.html</a> || Latest Nix: <a href="http://nixos.org/nix/download.html">http://nixos.org/nix/download.html</a> || Logs: <a href="http://nixos.org/irc/logs/">http://nixos.org/irc/logs/</a> || Swag: <a href="http://www.cafepress.co.uk/NixOS">http://www.cafepress.co.uk/NixOS</a></b><br/>
<font size="2">(09:10:55 PM)</font><b> Topic for #nixos set by niksnut!~eelco@ec2-54-216-36-73.eu-west-1.compute.amazonaws.com at 12:56:59 PM on 04/11/2014</b><br/>
<font color="#16569E"><font size="2">(09:13:37 PM)</font> <b>magnetophon:</b></font> I just upgraded to 14.12, and now X11 doesn't run anymore. I have no displaymanager, so I run &quot;xlaunch i3&quot;. It runs and gives some output, and then hangs on a black screen with a non-blinking cursor. I cannot switch tty's anymore at that point.  :(<br/>
<font color="#A82F2F"><font size="2">(09:14:11 PM)</font> <b>Lethalman:</b></font> magnetophon, did you reboot?<br/>
<font color="#16569E"><font size="2">(09:14:20 PM)</font> <b>magnetophon:</b></font> Lethalman: yes<br/>
<font color="#A82F2F"><font size="2">(09:15:38 PM)</font> <b>Lethalman:</b></font> magnetophon, are you able to obtain /var/log/X.0.log<br/>
<font color="#16569E"><font size="2">(09:15:54 PM)</font> <b>magnetophon:</b></font> Lethalman: I was in X11 during the upgrade, and it just kept running. Only after a reboot I got into trouble. I rebooted another time to make sure. No dice...<br/>
<font color="#16569E"><font size="2">(09:16:04 PM)</font> <b>magnetophon:</b></font> Lethalman: one sec<br/>
<font color="#A82F2F"><font size="2">(09:17:36 PM)</font> <b>NixOS_GitHub:</b></font> (notice) [nixpkgs] iElectric closed pull request #5522: Added jack support flag for mpd. (master...mpd-jack-support) http://git.io/gzhktw<br/>
<font color="#A82F2F"><font size="2">(09:18:32 PM)</font> <b>iElectric:</b></font> magnetophon: what graphic card/drivers?<br/>
<font color="#16569E"><font size="2">(09:19:38 PM)</font> <b>magnetophon:</b></font> Lethalman: http://nixpaste.noip.me/8WHMmYx4<br/>
<font color="#A82F2F"><font size="2">(09:20:11 PM)</font> <b>Lethalman:</b></font> (EE) synaptics: SynPS/2 Synaptics TouchPad: Synaptics driver unable to detect protocol<br/>
<font color="#A82F2F"><font size="2">(09:20:35 PM)</font> <b>Lethalman:</b></font> it&apos;s like the upgrade broke some configuration of yours about synaptics<br/>
<font color="#16569E"><font size="2">(09:20:36 PM)</font> <b>magnetophon:</b></font> iElectric: 00:02.0 VGA compatible controller: Intel Corporation Mobile 945GSE Express Integrated Graphics Controller (rev 03)<br/>
<font color="#16569E"><font size="2">(09:20:36 PM)</font> <b>magnetophon:</b></font> 00:02.1 Display controller: Intel Corporation Mobile 945GM/GMS/GME, 943/940GML Express Integrated Graphics Controller (rev 03)<br/>
<font color="#A82F2F"><font size="2">(09:20:45 PM)</font> <b>Lethalman:</b></font> you have some special configuration about your touchpad?<br/>
<font color="#16569E"><font size="2">(09:21:51 PM)</font> <b>magnetophon:</b></font> Lethalman: a bit: https://github.com/magnetophon/nixosConfig/blob/master/synaptics.nix<br/>
<font color="#A82F2F"><font size="2">(09:22:42 PM)</font> <b>Lethalman:</b></font> only that?<br/>
<font color="#16569E"><font size="2">(09:22:54 PM)</font> <b>magnetophon:</b></font> Lethalman: afaik, yes<br/>
<font color="#A82F2F"><font size="2">(09:23:37 PM)</font> <b>Lethalman:</b></font> magnetophon, you have an old configuration to run with right? I think you should be able to see the diff between the old xorg config and the new one<br/>
<font color="#16569E"><font size="2">(09:24:46 PM)</font> <b>magnetophon:</b></font> Lethalman: I'm running my last 14.04 config right now<br/>
<font color="#16569E"><font size="2">(09:25:18 PM)</font> <b>magnetophon:</b></font> Lethalman: so that xorg log might be related to my current boot (into X11)<br/>
<font color="#16569E"><font size="2">(09:25:38 PM)</font> <b>magnetophon:</b></font> Lethalman: sorry should have mentioned that earlier!<br/>
<font color="#A82F2F"><font size="2">(09:26:06 PM)</font> <b>Lethalman:</b></font> :S<br/>
<font color="#A82F2F"><font size="2">(09:26:14 PM)</font> <b>Lethalman:</b></font> magnetophon, there should be an old xorg log then<br/>
<font color="#A82F2F"><font size="2">(09:26:25 PM)</font> <b>Lethalman:</b></font> related to the newer config<br/>
<font color="#16569E"><font size="2">(09:27:22 PM)</font> <b>magnetophon:</b></font> Lethalman: http://nixpaste.noip.me/pAw-LVgK<br/>
<font color="#16569E"><font size="2">(09:27:53 PM)</font> <b>magnetophon:</b></font> Lethalman: that's the output of cat /var/log/X.0.log.old | nixpaste<br/>
<font color="#A82F2F"><font size="2">(09:28:10 PM)</font> <b>Lethalman:</b></font> weird, no error<br/>
<font color="#A82F2F"><font size="2">(09:28:18 PM)</font> <b>Lethalman:</b></font> magnetophon, perhaps it&apos;s your wm that is crashing<br/>
<font color="#A82F2F"><font size="2">(09:28:36 PM)</font> <b>Lethalman:</b></font> magnetophon, try looking into journalctl of the older boot<br/>
<font color="#16569E"><font size="2">(09:28:43 PM)</font> <b>magnetophon:</b></font> Lethalman: I can try xlaunch xterm?<br/>
<font color="#16569E"><font size="2">(09:28:58 PM)</font> <b>magnetophon:</b></font> Lethalman: how do I do that?<br/>
<font color="#A82F2F"><font size="2">(09:29:08 PM)</font> <b>Lethalman:</b></font> magnetophon, well, launch journalctl and see :P<br/>
<font color="#A82F2F"><font size="2">(09:29:19 PM)</font> <b>Lethalman:</b></font> magnetophon, better journalctl -r<br/>
<font size="2">(09:32:06 PM)</font><b> MichaelRaskin [<em>~MichaelRa@195.91.224.161</em>] entered the room.</b><br/>
<font color="#16569E"><font size="2">(09:32:27 PM)</font> <b>magnetophon:</b></font> Lethalman: hmm, doesn't really ring any bells. Want a paste?<br/>
<font color="#A82F2F"><font size="2">(09:33:12 PM)</font> <b>Lethalman:</b></font> well you should see some premature display-manager death<br/>
<font color="#16569E"><font size="2">(09:33:35 PM)</font> <b>magnetophon:</b></font> Lethalman: also I have a custom kernel, and during the build I got:   DEPMOD  3.14.27<br/>
<font color="#16569E"><font size="2">(09:33:35 PM)</font> <b>magnetophon:</b></font> depmod: ERROR: Module 'hci_vhci' has devname (vhci) but lacks major and minor information. Ignoring.<br/>
<font color="#16569E"><font size="2">(09:33:35 PM)</font> <b>magnetophon:</b></font> not sure if it's related...<br/>
<font color="#16569E"><font size="2">(09:36:53 PM)</font> <b>magnetophon:</b></font> Lethalman: journalctl -r | grep i3 only gives me lines like: Jan 01 21:09:45 NIX kernel: scsi3 : ahci <br/>
<font color="#A82F2F"><font size="2">(09:37:05 PM)</font> <b>Lethalman:</b></font> magnetophon, try grepping display-manager<br/>
<font color="#16569E"><font size="2">(09:38:12 PM)</font> <b>magnetophon:</b></font> Lethalman: only stuff from last week and older<br/>
<font color="#A82F2F"><font size="2">(09:38:44 PM)</font> <b>Lethalman:</b></font> a little out of ideas<br/>
<font color="#A82F2F"><font size="2">(09:38:49 PM)</font> <b>Lethalman:</b></font> but doesn&apos;t seem a problem of X from the log<br/>
<font color="#A82F2F"><font size="2">(09:38:58 PM)</font> <b>Lethalman:</b></font> unless that&apos;s not the log from the new config<br/>
<font color="#16569E"><font size="2">(09:40:26 PM)</font> <b>magnetophon:</b></font> Lethalman: well that log does mention 3.14.27 so it kind of must be, right?<br/>
<font color="#A82F2F"><font size="2">(09:40:33 PM)</font> <b>Lethalman:</b></font> right<br/>
<font color="#16569E"><font size="2">(09:42:16 PM)</font> <b>magnetophon:</b></font> Lethalman: I'll paste the output of journalctl -r.  Maybe something will pop out at you when you have a look.  One sec... <br/>
<font color="#A82F2F"><font size="2">(09:42:53 PM)</font> <b>Lethalman:</b></font> ok<br/>
<font color="#16569E"><font size="2">(09:43:54 PM)</font> <b>magnetophon:</b></font> Lethalman: thanks for trying !!!!!!!<br/>
<font color="#16569E"><font size="2">(09:44:53 PM)</font> <b>magnetophon:</b></font> Lethalman: hmmmm:    journalctl -r | nixpaste<br/>
<font color="#16569E"><font size="2">(09:44:53 PM)</font> <b>magnetophon:</b></font> curl: (52) Empty reply from server<br/>
<font color="#A82F2F"><font size="2">(09:45:06 PM)</font> <b>Lethalman:</b></font> magnetophon, too big probably :)<br/>
<font color="#A82F2F"><font size="2">(09:45:15 PM)</font> <b>Lethalman:</b></font> magnetophon, journactl keeps all the logs<br/>
<font color="#A82F2F"><font size="2">(09:45:17 PM)</font> <b>Lethalman:</b></font> so it&apos;s probably big<br/>
<font color="#16569E"><font size="2">(09:45:29 PM)</font> <b>magnetophon:</b></font> was just about to suggest that<br/>
<font color="#A82F2F"><font size="2">(09:45:30 PM)</font> <b>MichaelRaskin:</b></font> Lethalman: can also be a timeout<br/>
<font color="#16569E"><font size="2">(09:45:47 PM)</font> <b>magnetophon:</b></font> how do I make it smaller?<br/>
<font color="#A82F2F"><font size="2">(09:45:59 PM)</font> <b>MichaelRaskin:</b></font> journalctl -b is a good start, I think<br/>
<font color="#A82F2F"><font size="2">(09:45:59 PM)</font> <b>Lethalman:</b></font> magnetophon, head -n 10000 should suffice<br/>
<font color="#A82F2F"><font size="2">(09:46:06 PM)</font> <b>Lethalman:</b></font> MichaelRaskin, -b is not a good idea<br/>
<font color="#A82F2F"><font size="2">(09:46:15 PM)</font> <b>Lethalman:</b></font> he needs the log of the previous boot<br/>
<font color="#A82F2F"><font size="2">(09:46:18 PM)</font> <b>MichaelRaskin:</b></font> Ah<br/>
<font color="#A82F2F"><font size="2">(09:46:23 PM)</font> <b>MichaelRaskin:</b></font> my bad<br/>
<font color="#A82F2F"><font size="2">(09:47:00 PM)</font> <b>MichaelRaskin:</b></font> I guess --since and the dual option could help<br/>
<font color="#16569E"><font size="2">(09:47:26 PM)</font> <b>magnetophon:</b></font> journalctl -r | head -n 10000 | nixpaste<br/>
<font color="#16569E"><font size="2">(09:47:26 PM)</font> <b>magnetophon:</b></font> http://nixpaste.noip.me/ggxg9iuH<br/>
<font color="#A82F2F"><font size="2">(09:47:37 PM)</font> <b>kmicu:</b></font> You can match only one boot.<br/>
<font color="#A82F2F"><font size="2">(09:47:53 PM)</font> <b>kmicu:</b></font> journalctl -b 2|1|etc<br/>
<font color="#A82F2F"><font size="2">(09:48:10 PM)</font> <b>kmicu:</b></font> And --list-boots to check which one.<br/>
<font color="#A82F2F"><font size="2">(09:48:55 PM)</font> <b>McEnroe:</b></font> Is anyone currently working on mesa updates?<br/>
<font color="#16569E"><font size="2">(09:49:01 PM)</font> <b>magnetophon:</b></font> kmicu: that went over my head<br/>
<font color="#16569E"><font size="2">(09:49:31 PM)</font> <b>magnetophon:</b></font> Could my problem be related to my kernel? https://github.com/magnetophon/nixosConfig/blob/master/configuration.nix#L45-L58<br/>
<font size="2">(09:50:12 PM)</font><b> thoughtp1lice is now known as thoughtpolice</b><br/>
<font size="2">(09:50:14 PM)</font><b> roconnor [<em>~roconnor@e120-pool-d89a63c0.brdbnd.voicenetwork.ca</em>] entered the room.</b><br/>
<font color="#A82F2F"><font size="2">(09:50:24 PM)</font> <b>Lethalman:</b></font> magnetophon, it&apos;s weird sorry, no idea<br/>
<font color="#16569E"><font size="2">(09:51:06 PM)</font> <b>magnetophon:</b></font> Lethalman: well, again: thanks a lot for trying!<br/>
<font color="#A82F2F"><font size="2">(09:51:26 PM)</font> <b>kmicu:</b></font> magnetophon: thanks, now I see that I have 47 boots in my journal. Time for cleaning.<br/>
<font color="#16569E"><font size="2">(09:52:34 PM)</font> <b>magnetophon:</b></font> kmicu: journalctl --list-boots only lists stuff from last year. I upgraded today.  Does that mean I don't have logs of my actual problem?<br/>
<font color="#A82F2F"><font size="2">(09:53:07 PM)</font> <b>Lethalman:</b></font> magnetophon, I see in your paste the logs of 14.12<br/>
<font color="#A82F2F"><font size="2">(09:53:20 PM)</font> <b>Lethalman:</b></font> it boots fine, everything ok, then you login and reboot<br/>
<font color="#A82F2F"><font size="2">(09:53:24 PM)</font> <b>Lethalman:</b></font> or such<br/>
<font color="#A82F2F"><font size="2">(09:53:26 PM)</font> <b>Lethalman:</b></font> but no errors<br/>
<font color="#16569E"><font size="2">(09:54:25 PM)</font> <b>magnetophon:</b></font> Lethalman: afaik it boots fine, everything ok, then I login, run xlaunch i3 and I get a crash<br/>
<font color="#A82F2F"><font size="2">(09:55:41 PM)</font> <b>MichaelRaskin:</b></font> magnetophon: you have fresh NixOS build?<br/>
<font color="#A82F2F"><font size="2">(09:55:44 PM)</font> <b>kmicu:</b></font> magnetophon: I have all logs since ‘-48 2e2eea074be741259b27a4d4ca94db96 Thu 2014-11-13 20:41:13 CET—Thu 2014-11-13 23:57:59 CET’ I have no idea how NixOS handle journal on upgrade.<br/>
<font color="#16569E"><font size="2">(09:55:46 PM)</font> <b>magnetophon:</b></font> Lethalman: maybe I should wait longer: when I have the black screen with the (non-blinking) cursor, I DO get occasional hard-disk lights<br/>
<font color="#16569E"><font size="2">(09:56:10 PM)</font> <b>magnetophon:</b></font> MichaelRaskin: what do you mean?<br/>
<font color="#A82F2F"><font size="2">(09:56:27 PM)</font> <b>MichaelRaskin:</b></font> You have xlaunch failures since you have updated NixOS, right?<br/>
<font color="#16569E"><font size="2">(09:56:41 PM)</font> <b>magnetophon:</b></font> MichaelRaskin: yes<br/>
<font color="#A82F2F"><font size="2">(09:56:47 PM)</font> <b>MichaelRaskin:</b></font> And you have updated it from something old to something recent<br/>
<font color="#16569E"><font size="2">(09:57:06 PM)</font> <b>magnetophon:</b></font> from 14.04 to 14.12, yes<br/>
<font color="#16569E"><font size="2">(09:57:14 PM)</font> <b>magnetophon:</b></font> MichaelRaskin: ^^<br/>
<font color="#A82F2F"><font size="2">(09:57:23 PM)</font> <b>MichaelRaskin:</b></font> Sorry, but systemd update happenned in between. And systemd currently thinks that anything remotely resembling startx or xinit should be broken<br/>
<font color="#A82F2F"><font size="2">(09:58:45 PM)</font> <b>MichaelRaskin:</b></font> If you strace an attempt to launch Xorg as root, you will see an EPERM for a trivial syscall<br/>
<font color="#A82F2F"><font size="2">(09:59:15 PM)</font> <b>MichaelRaskin:</b></font> (ioctl to set the display mode, actually)<br/>
<font color="#A82F2F"><font size="2">(10:00:26 PM)</font> <b>Lethalman:</b></font> oh right<br/>
<font color="#A82F2F"><font size="2">(10:00:27 PM)</font> <b>MichaelRaskin:</b></font> Which is why I am currently running some hacked together system instead of NixOS (comfortably using NixPkgs as my only package source)<br/>
<font color="#A82F2F"><font size="2">(10:00:28 PM)</font> <b>Lethalman:</b></font> :S<br/>
<font color="#A82F2F"><font size="2">(10:00:51 PM)</font> <b>MichaelRaskin:</b></font> And so I wait till SAL is merged<br/>
<font color="#A82F2F"><font size="2">(10:01:19 PM)</font> <b>MichaelRaskin:</b></font> So I can quickly port all services I need to it and use s6 or openrc or something<br/>
<font color="#A82F2F"><font size="2">(10:01:30 PM)</font> <b>Lethalman:</b></font> I don&apos;t think SAL is enough<br/>
<font color="#A82F2F"><font size="2">(10:01:38 PM)</font> <b>Lethalman:</b></font> no?<br/>
<font color="#A82F2F"><font size="2">(10:01:46 PM)</font> <b>MichaelRaskin:</b></font> We-ell<br/>
<font color="#A82F2F"><font size="2">(10:01:48 PM)</font> <b>Lethalman:</b></font> MichaelRaskin, how do you deal with e.g. systemd-logind?<br/>
<font color="#16569E"><font size="2">(10:01:50 PM)</font> <b>magnetophon:</b></font> MichaelRaskin: Am I following you correctly: I should reboot, do &quot;strace xlaunch i3&quot;, and report back?   I thinks you guys have lost me...<br/>
<font color="#A82F2F"><font size="2">(10:01:54 PM)</font> <b>Lethalman:</b></font> you have it running or what?<br/>
<font color="#A82F2F"><font size="2">(10:02:09 PM)</font> <b>Lethalman:</b></font> magnetophon, yes, strace -f<br/>
<font color="#A82F2F"><font size="2">(10:02:23 PM)</font> <b>MichaelRaskin:</b></font> magnetophon: actually...<br/>
<font color="#A82F2F"><font size="2">(10:02:27 PM)</font> <b>MichaelRaskin:</b></font> Little chance<br/>
<font color="#16569E"><font size="2">(10:02:51 PM)</font> <b>magnetophon:</b></font> Lethalman: will it write a log that I can paste when back in 14.04 ?<br/>
<font color="#A82F2F"><font size="2">(10:02:53 PM)</font> <b>MichaelRaskin:</b></font> It seems to be core systemd wish to break any tools that would correspond to your needs<br/>
<font color="#A82F2F"><font size="2">(10:03:02 PM)</font> <b>Lethalman:</b></font> magnetophon, it logs to stderr<br/>
<font color="#A82F2F"><font size="2">(10:03:13 PM)</font> <b>Lethalman:</b></font> magnetophon, try saving it in a file, e.g. strace -f .... &amp;&gt; somefile<br/>
<font color="#A82F2F"><font size="2">(10:03:19 PM)</font> <b>MichaelRaskin:</b></font> Lethalman: I have nothing from systemd running<br/>
<font color="#A82F2F"><font size="2">(10:03:42 PM)</font> <b>MichaelRaskin:</b></font> agetty actually works<br/>
<font color="#A82F2F"><font size="2">(10:04:03 PM)</font> <b>Lethalman:</b></font> MichaelRaskin, well yes, software has still some fallback when logind is not available fortunately :S<br/>
<font color="#A82F2F"><font size="2">(10:04:12 PM)</font> <b>MichaelRaskin:</b></font> eudev does the few tasks you actually need from udev now with devfs-done-again<br/>
<font color="#A82F2F"><font size="2">(10:04:33 PM)</font> <b>Lethalman:</b></font> not sure how long it will last until logind will replace the old vt switching stuff<br/>
<font color="#16569E"><font size="2">(10:04:39 PM)</font> <b>magnetophon:</b></font> Lethalman: so I do (as root): strace -f xlaunch i3 &amp;&gt; somefile<br/>
<font color="#A82F2F"><font size="2">(10:04:40 PM)</font> <b>Lethalman:</b></font> *completely replace*<br/>
<font color="#A82F2F"><font size="2">(10:04:44 PM)</font> <b>MichaelRaskin:</b></font> devtmpfs, that&apos;s what it is called<br/>
<font color="#A82F2F"><font size="2">(10:04:45 PM)</font> <b>Lethalman:</b></font> magnetophon, yeah<br/>
<font color="#A82F2F"><font size="2">(10:05:05 PM)</font> <b>MichaelRaskin:</b></font> Lethalman: I am not sure that change would ever be merged by Linus<br/>
<font color="#A82F2F"><font size="2">(10:05:15 PM)</font> <b>Lethalman:</b></font> MichaelRaskin, not linus, but software like xorg :P<br/>
<font color="#16569E"><font size="2">(10:05:31 PM)</font> <b>magnetophon:</b></font> Lethalman, MichaelRaskin: thanks. BRB<br/>
<font color="#A82F2F"><font size="2">(10:05:32 PM)</font> <b>Lethalman:</b></font> vt allocation is there to say for many years of course in linux<br/>
<font color="#A82F2F"><font size="2">(10:05:40 PM)</font> <b>MichaelRaskin:</b></font> Lethalman: KMS means that Xorg doesn&apos;t manage its VT switches anyway<br/>
<font color="#A82F2F"><font size="2">(10:06:11 PM)</font> <b>MichaelRaskin:</b></font> Lethalman: actually, systemd already has code for running without Linux VT allocation<br/>
<font color="#A82F2F"><font size="2">(10:06:15 PM)</font> <b>MichaelRaskin:</b></font> and, to quote:<br/>
