<html><head><meta http-equiv="content-type" content="text/html; charset=UTF-8"><title>Conversation with #nixos at Sat 04 Apr 2015 02:14:56 AM CEST on magnetophon@irc.freenode.net (irc)</title></head><body><h3>Conversation with #nixos at Sat 04 Apr 2015 02:14:56 AM CEST on magnetophon@irc.freenode.net (irc)</h3>
<font size="2">(02:14:56 AM)</font><b> The topic for #nixos is: <a href="http://nixos.org/">http://nixos.org/</a> || Latest NixOS: <a href="http://nixos.org/nixos/download.html">http://nixos.org/nixos/download.html</a> || Latest Nix: <a href="http://nixos.org/nix/download.html">http://nixos.org/nix/download.html</a> || Logs: <a href="http://nixos.org/irc/logs/">http://nixos.org/irc/logs/</a> || Swag: <a href="http://www.cafepress.co.uk/NixOS">http://www.cafepress.co.uk/NixOS</a></b><br/>
<font size="2">(02:14:56 AM)</font><b> Topic for #nixos set by niksnut!~eelco@ec2-54-216-36-73.eu-west-1.compute.amazonaws.com at 12:56:59 PM on 04/11/2014</b><br/>
<font color="#A82F2F"><font size="2">(02:32:57 AM)</font> <b>NixOS_GitHub:</b></font> (notice) [nixpkgs] nckx pushed 6 new commits to master: http://git.io/veOdB<br/>
<font color="#A82F2F"><font size="2">(02:32:57 AM)</font> <b>NixOS_GitHub:</b></font> (notice) nixpkgs/master 69b0873 Tobias Geerinckx-Rice: duff, nxproxy, libxcomp: use autoreconfHook<br/>
<font color="#A82F2F"><font size="2">(02:32:57 AM)</font> <b>NixOS_GitHub:</b></font> (notice) nixpkgs/master 93fc9ba Tobias Geerinckx-Rice: python-packages: pgcli 0.16.2 -&gt; 0.16.3...<br/>
<font color="#A82F2F"><font size="2">(02:32:57 AM)</font> <b>NixOS_GitHub:</b></font> (notice) nixpkgs/master 5e6aca8 Tobias Geerinckx-Rice: vim-plugins: wakatime 3.0.8 -&gt; 3.0.9...<br/>
<font color="#A82F2F"><font size="2">(03:34:06 AM)</font> <b>NixOS_GitHub:</b></font> (notice) [nixpkgs] wkennington pushed 1 new commit to master: http://git.io/ve3fB<br/>
<font color="#A82F2F"><font size="2">(03:34:06 AM)</font> <b>NixOS_GitHub:</b></font> (notice) nixpkgs/master 5f87dd1 William A. Kennington III: samba4: Lots of code cleanups<br/>
<font color="#A82F2F"><font size="2">(03:39:19 AM)</font> <b>NixOS_GitHub:</b></font> (notice) [nixpkgs] wkennington pushed 2 new commits to master: http://git.io/ve3Jl<br/>
<font color="#A82F2F"><font size="2">(03:39:19 AM)</font> <b>NixOS_GitHub:</b></font> (notice) nixpkgs/master 6a08748 William A. Kennington III: libmsgpack: 1.0.1 -&gt; 1.1.0<br/>
<font color="#A82F2F"><font size="2">(03:39:19 AM)</font> <b>NixOS_GitHub:</b></font> (notice) nixpkgs/master 4e10639 William A. Kennington III: msgpack-python: 0.4.2 -&gt; 0.4.6<br/>
<font color="#A82F2F"><font size="2">(04:17:49 AM)</font> <b>NixOS_GitHub:</b></font> (notice) [nixpkgs] wkennington pushed 4 new commits to master: http://git.io/ve3LA<br/>
<font color="#A82F2F"><font size="2">(04:17:49 AM)</font> <b>NixOS_GitHub:</b></font> (notice) nixpkgs/master 60b8b5a William A. Kennington III: nettle: Refactor to be generic<br/>
<font color="#A82F2F"><font size="2">(04:17:49 AM)</font> <b>NixOS_GitHub:</b></font> (notice) nixpkgs/master 5a9cf63 William A. Kennington III: nettle: Add version 3.0 as the default<br/>
<font color="#A82F2F"><font size="2">(04:17:49 AM)</font> <b>NixOS_GitHub:</b></font> (notice) nixpkgs/master 23ed4c2 William A. Kennington III: gnutls: Make generic and upgrade to 3.2.21<br/>
<font size="2">(04:32:07 AM)</font><b> c74d is now known as Guest90028</b><br/>
<font color="#A82F2F"><font size="2">(04:35:57 AM)</font> <b>NixOS_GitHub:</b></font> (notice) [nixpkgs] wkennington pushed 1 new commit to master: http://git.io/ve3mC<br/>
<font color="#A82F2F"><font size="2">(04:35:57 AM)</font> <b>NixOS_GitHub:</b></font> (notice) nixpkgs/master 72c6afe William A. Kennington III: samba4: Correct accidental change of kerberos library<br/>
<font color="#A82F2F"><font size="2">(05:08:20 AM)</font> <b>auntie:</b></font> my connection isn&apos;t reliable enough for curl that nix uses... I end up downloading big things with the &apos;wget --continue&apos; flag :(<br/>
<font color="#A82F2F"><font size="2">(05:36:02 AM)</font> <b>Fylwind:</b></font> is it normal for &apos;nixos-rebuild switch --upgrade&apos; to lock up the entire machine with 100% CPU?<br/>
<font color="#A82F2F"><font size="2">(05:36:46 AM)</font> <b>NixOS_GitHub:</b></font> (notice) [nixpkgs] cstrahan opened pull request #7161: haskell: fix taffybar on GHC 7.10 (master...taffybar-fix) http://git.io/ve3cn<br/>
<font color="#A82F2F"><font size="2">(05:37:24 AM)</font> <b>Fylwind:</b></font> the last message before locking up was &quot;stopping the following units: …&quot;<br/>
<font color="#A82F2F"><font size="2">(05:38:04 AM)</font> <b>aszlig:</b></font> auntie: what about NIX_CURL_FLAGS=&apos;--retry=1000&apos; or something like that?<br/>
<font color="#A82F2F"><font size="2">(05:38:49 AM)</font> <b>aszlig:</b></font> Fylwind: during evaluation maybe, but in your case it shouldn&apos;t lock up like that<br/>
<font color="#A82F2F"><font size="2">(05:40:32 AM)</font> <b>aszlig:</b></font> Fylwind: if you just run the switch-to-configuration script, does it happen there as well?<br/>
<font color="#A82F2F"><font size="2">(05:41:16 AM)</font> <b>aszlig:</b></font> Fylwind: something like with /nix/var/nix/profiles/system/bin/switch-to-configuration test<br/>
<font color="#A82F2F"><font size="2">(05:41:35 AM)</font> <b>aszlig:</b></font> and if yes, you could try stracing it to find out what&apos;s wrong<br/>
<font color="#A82F2F"><font size="2">(05:41:51 AM)</font> <b>Fylwind:</b></font> aszlig: I can try that and see<br/>
<font color="#A82F2F"><font size="2">(05:42:14 AM)</font> <b>Fylwind:</b></font> (this is on a VM btw, from the image on the official website)<br/>
<font color="#A82F2F"><font size="2">(05:42:38 AM)</font> <b>auntie:</b></font> aszlig: that&apos;s perfect :D<br/>
<font color="#A82F2F"><font size="2">(05:42:47 AM)</font> <b>wkennington:</b></font> aszlig: do you know how to list referrers of a package from all-packages?<br/>
<font color="#A82F2F"><font size="2">(05:43:02 AM)</font> <b>wkennington:</b></font> i&apos;ve been using grep for far too long<br/>
<font color="#A82F2F"><font size="2">(05:45:30 AM)</font> <b>aszlig:</b></font> wkennington: basically i&apos;m using grep as well for a quick test and test the rest on my hydra, but it shouldn&apos;t be too hard to find out the changes<br/>
<font color="#A82F2F"><font size="2">(05:45:38 AM)</font> <b>wkennington:</b></font> aszlig: ah dang<br/>
<font color="#A82F2F"><font size="2">(05:45:45 AM)</font> <b>aszlig:</b></font> wkennington: you could instantiate the release.nix and do a diff on the drvs<br/>
<font color="#A82F2F"><font size="2">(05:45:48 AM)</font> <b>wkennington:</b></font> yeah<br/>
<font color="#A82F2F"><font size="2">(05:45:53 AM)</font> <b>Fylwind:</b></font> aszlig: the command seems to work<br/>
<font color="#A82F2F"><font size="2">(05:45:55 AM)</font> <b>wkennington:</b></font> supposedly there is a nice way to instantiate<br/>
<font color="#A82F2F"><font size="2">(05:46:01 AM)</font> <b>wkennington:</b></font> and get the deps<br/>
<font color="#A82F2F"><font size="2">(05:46:18 AM)</font> <b>aszlig:</b></font> wkennington: lemme see<br/>
<font color="#A82F2F"><font size="2">(05:46:53 AM)</font> <b>Fylwind:</b></font> aszlig: so I tried nixos-rebuild switch --upgrade and now it worked<br/>
<font color="#A82F2F"><font size="2">(05:47:53 AM)</font> <b>Fylwind:</b></font> *shrugs*<br/>
<font color="#A82F2F"><font size="2">(05:47:57 AM)</font> <b>aszlig:</b></font> Fylwind: hm, that might be just one service blocking at 100% cpu load back then<br/>
<font color="#A82F2F"><font size="2">(05:48:19 AM)</font> <b>aszlig:</b></font> Fylwind: i think you can chock using systemd-analyze<br/>
<font color="#A82F2F"><font size="2">(05:49:22 AM)</font> <b>Fylwind:</b></font> aszlig: good idea!<br/>
<font color="#A82F2F"><font size="2">(05:50:00 AM)</font> <b>wkennington:</b></font> aszlig: maybe i was wrong, i asked someone else who believed it was easy. looks like they were talking about nix-store --query --referrers<br/>
<font color="#A82F2F"><font size="2">(05:50:30 AM)</font> <b>wkennington:</b></font> i guess grep will work :p<br/>
<font size="2">(05:50:32 AM)</font><b> c74d is now known as Guest93542</b><br/>
<font color="#A82F2F"><font size="2">(05:51:00 AM)</font> <b>aszlig:</b></font> wkennington: well, no... actually you could do a nix-instantiate nixos/release-combined.nix -A tested<br/>
<font color="#A82F2F"><font size="2">(05:51:15 AM)</font> <b>aszlig:</b></font> but that wouldn&apos;t give you everything<br/>
<font color="#A82F2F"><font size="2">(05:51:17 AM)</font> <b>wkennington:</b></font> right<br/>
<font color="#A82F2F"><font size="2">(05:51:22 AM)</font> <b>aszlig:</b></font> however...<br/>
<font color="#A82F2F"><font size="2">(05:51:29 AM)</font> <b>aszlig:</b></font> if you instantiate every drv<br/>
<font color="#A82F2F"><font size="2">(05:51:34 AM)</font> <b>wkennington:</b></font> i could also instantiate pkgs/top-level/release.nix<br/>
<font color="#A82F2F"><font size="2">(05:51:39 AM)</font> <b>wkennington:</b></font> yeah<br/>
<font color="#A82F2F"><font size="2">(05:51:48 AM)</font> <b>wkennington:</b></font> what would i read then?<br/>
<font color="#A82F2F"><font size="2">(05:51:49 AM)</font> <b>aszlig:</b></font> you can use nix-store -q --referrers on the drv and get out all referers<br/>
<font color="#A82F2F"><font size="2">(05:51:54 AM)</font> <b>wkennington:</b></font> could i query referrers?<br/>
<font color="#A82F2F"><font size="2">(05:51:56 AM)</font> <b>wkennington:</b></font> oh<br/>
<font color="#A82F2F"><font size="2">(05:51:58 AM)</font> <b>wkennington:</b></font> that works<br/>
<font color="#A82F2F"><font size="2">(05:52:02 AM)</font> <b>wkennington:</b></font> ill try that<br/>
<font color="#A82F2F"><font size="2">(05:52:18 AM)</font> <b>aszlig:</b></font> but of course only after instantiation<br/>
<font color="#A82F2F"><font size="2">(05:52:24 AM)</font> <b>wkennington:</b></font> right<br/>
<font color="#A82F2F"><font size="2">(05:52:47 AM)</font> <b>wkennington:</b></font> can you show trace on nix-instantiate.....<br/>
<font color="#A82F2F"><font size="2">(05:53:02 AM)</font> <b>aszlig:</b></font> like -v?<br/>
<font color="#A82F2F"><font size="2">(05:53:21 AM)</font> <b>aszlig:</b></font> ah, you mean like --graph?<br/>
<font color="#A82F2F"><font size="2">(05:54:07 AM)</font> <b>wkennington:</b></font> nix-instantiate pkgs/top-level/release.nix is giving an error at the moment<br/>
<font color="#A82F2F"><font size="2">(05:54:09 AM)</font> <b>aszlig:</b></font> that&apos;s probably only really possible afterwards<br/>
<font color="#A82F2F"><font size="2">(05:54:14 AM)</font> <b>wkennington:</b></font> it&apos;s not really clear what is broken<br/>
<font color="#A82F2F"><font size="2">(05:54:32 AM)</font> <b>aszlig:</b></font> oh, yeah<br/>
<font color="#A82F2F"><font size="2">(05:54:48 AM)</font> <b>wkennington:</b></font> there must be a way to get output like hydra does<br/>
<font color="#A82F2F"><font size="2">(05:54:57 AM)</font> <b>aszlig:</b></font> that&apos;s probably because you&apos;re evaluating things that throw assertions and things which are broken and other things<br/>
<font color="#A82F2F"><font size="2">(05:54:58 AM)</font> <b>wkennington:</b></font> which i believe uses something similar<br/>
<font color="#A82F2F"><font size="2">(05:55:02 AM)</font> <b>wkennington:</b></font> hmmm<br/>
<font color="#A82F2F"><font size="2">(05:55:04 AM)</font> <b>aszlig:</b></font> and also pkgs recursively<br/>
<font color="#A82F2F"><font size="2">(05:55:20 AM)</font> <b>wkennington:</b></font> i thought there was a point in time when nix-instantiate pkgs/top-level/all-packages.nix worked<br/>
<font color="#A82F2F"><font size="2">(05:55:27 AM)</font> <b>aszlig:</b></font> although only one level deep<br/>
<font color="#A82F2F"><font size="2">(05:55:33 AM)</font> <b>wkennington:</b></font> err<br/>
<font color="#A82F2F"><font size="2">(05:55:37 AM)</font> <b>aszlig:</b></font> but it should include pkgs itself once again<br/>
<font color="#A82F2F"><font size="2">(05:55:43 AM)</font> <b>wkennington:</b></font> s/all-packages/release/<br/>
<font color="#A82F2F"><font size="2">(05:55:56 AM)</font> <b>aszlig:</b></font> i&apos;d instantiate release.nix<br/>
<font color="#A82F2F"><font size="2">(05:58:31 AM)</font> <b>wkennington:</b></font> that&apos;s what i did?<br/>
<font color="#A82F2F"><font size="2">(05:58:38 AM)</font> <b>wkennington:</b></font> or you mean nixos/release.nix?<br/>
<font color="#A82F2F"><font size="2">(06:00:09 AM)</font> <b>aszlig:</b></font> ah<br/>
<font color="#A82F2F"><font size="2">(06:00:17 AM)</font> <b>aszlig:</b></font> well, you need to recurse for derivations<br/>
<font color="#A82F2F"><font size="2">(06:00:34 AM)</font> <b>aszlig:</b></font> sec<br/>
<font color="#A82F2F"><font size="2">(06:02:31 AM)</font> <b>wkennington:</b></font> yeah that definitely needs to recurse<br/>
<font color="#A82F2F"><font size="2">(06:07:07 AM)</font> <b>aszlig:</b></font> wkennington: nix-instantiate maintainers/scripts/eval-release.nix<br/>
<font color="#A82F2F"><font size="2">(06:07:36 AM)</font> <b>aszlig:</b></font> but that bails out on the same error<br/>
<font color="#A82F2F"><font size="2">(06:07:53 AM)</font> <b>aszlig:</b></font> which means something is _really_ broken<br/>
<font color="#A82F2F"><font size="2">(06:08:19 AM)</font> <b>aszlig:</b></font> -&gt; pkgs/applications/altcoins/default.nix<br/>
<font color="#A82F2F"><font size="2">(06:08:56 AM)</font> <b>aszlig:</b></font> hm, nope<br/>
<font color="#A82F2F"><font size="2">(06:10:15 AM)</font> <b>aszlig:</b></font> ah, sure<br/>
<font color="#A82F2F"><font size="2">(06:10:27 AM)</font> <b>aszlig:</b></font> of course, i&apos;m dumb...<br/>
<font color="#A82F2F"><font size="2">(06:14:20 AM)</font> <b>aszlig:</b></font> nix-instantiate --eval-only --strict maintainers/scripts/eval-release.nix<br/>
<font color="#A82F2F"><font size="2">(06:14:36 AM)</font> <b>aszlig:</b></font> that created all .drvs<br/>
<font color="#A82F2F"><font size="2">(06:17:06 AM)</font> <b>Fylwind:</b></font> what is the correct way of &apos;using&apos; modules such as: https://github.com/NixOS/nixpkgs/blob/master/nixos/modules/services/networking/ssh/sshd.nix<br/>
<font color="#A82F2F"><font size="2">(06:17:37 AM)</font> <b>Fylwind:</b></font> do I use &apos;imports = [ ./services/networking/ssh/sshd.nix ];&apos; or something?<br/>
<font color="#A82F2F"><font size="2">(06:17:59 AM)</font> <b>aszlig:</b></font> Fylwind: no, it&apos;s imported already<br/>
<font color="#A82F2F"><font size="2">(06:18:32 AM)</font> <b>Fylwind:</b></font> is it? I don&apos;t have an SSH daemon running<br/>
<font color="#A82F2F"><font size="2">(06:18:33 AM)</font> <b>aszlig:</b></font> Fylwind: modules usually come with a enable property which is defaulting to false<br/>
<font color="#A82F2F"><font size="2">(06:18:38 AM)</font> <b>aszlig:</b></font> at least for most modules<br/>
<font color="#A82F2F"><font size="2">(06:18:58 AM)</font> <b>NixOS_GitHub:</b></font> (notice) [nixpkgs] thoughtpolice pushed 1 new commit to master: http://git.io/ve34R<br/>
<font color="#A82F2F"><font size="2">(06:18:58 AM)</font> <b>NixOS_GitHub:</b></font> (notice) nixpkgs/master 83a6da7 Austin Seipp: rakudo: 2014.04 -&gt; 2015.03...<br/>
<font color="#A82F2F"><font size="2">(06:19:26 AM)</font> <b>aszlig:</b></font> Fylwind: it is not running because you&apos;re using the module but you didn&apos;t set the enable property declared by it to true<br/>
<font color="#A82F2F"><font size="2">(06:19:45 AM)</font> <b>Fylwind:</b></font> ah<br/>
<font color="#A82F2F"><font size="2">(06:20:07 AM)</font> <b>aszlig:</b></font> Fylwind: so services.openssh.enable = true; will actually use the config properties defined by that module<br/>
<font color="#A82F2F"><font size="2">(06:20:34 AM)</font> <b>aszlig:</b></font> Fylwind: see this mkIf? https://github.com/NixOS/nixpkgs/blob/master/nixos/modules/services/networking/ssh/sshd.nix#L282<br/>
<font color="#A82F2F"><font size="2">(06:21:23 AM)</font> <b>aszlig:</b></font> the first argument is the condition and the second is the attrset of config values if the condition holds true<br/>
<font color="#A82F2F"><font size="2">(06:22:14 AM)</font> <b>Fylwind:</b></font> aszlig: I see; where is the proper place to declare the config variable?<br/>
<font color="#A82F2F"><font size="2">(06:22:33 AM)</font> <b>Fylwind:</b></font> in configuration.nix?<br/>
<font color="#A82F2F"><font size="2">(06:22:35 AM)</font> <b>aszlig:</b></font> Fylwind: yep<br/>
<font color="#A82F2F"><font size="2">(06:22:42 AM)</font> <b>aszlig:</b></font> configuration.nix is yet another module<br/>
<font color="#A82F2F"><font size="2">(06:23:11 AM)</font> <b>aszlig:</b></font> you can also factor it out to another file, just as with every other nixos module<br/>
<font color="#A82F2F"><font size="2">(06:23:20 AM)</font> <b>wkennington:</b></font> aszlig: thanks<br/>
<font color="#A82F2F"><font size="2">(06:23:41 AM)</font> <b>aszlig:</b></font> Fylwind: for more information on this: http://nixos.org/nixos/manual/sec-writing-modules.html<br/>
<font color="#A82F2F"><font size="2">(06:27:45 AM)</font> <b>NixOS_GitHub:</b></font> (notice) [nixpkgs] wkennington pushed 1 new commit to master: http://git.io/ve3Bt<br/>
<font color="#A82F2F"><font size="2">(06:27:45 AM)</font> <b>NixOS_GitHub:</b></font> (notice) nixpkgs/master de9c9bd William A. Kennington III: gnutls: Make 3.3 the default<br/>
<font color="#A82F2F"><font size="2">(06:28:18 AM)</font> <b>Fylwind:</b></font> aszlig: thanks a lot<br/>
<font color="#A82F2F"><font size="2">(06:38:47 AM)</font> <b>NixOS_GitHub:</b></font> (notice) [nixpkgs] vcunat pushed 1 new commit to master: http://git.io/ve3RT<br/>
<font color="#A82F2F"><font size="2">(06:38:47 AM)</font> <b>NixOS_GitHub:</b></font> (notice) nixpkgs/master aa5d253 Vladimír Čunát: hhvm: disable parallel building...<br/>
<font color="#A82F2F"><font size="2">(06:56:59 AM)</font> <b>NixOS_GitHub:</b></font> (notice) [nixpkgs] wkennington pushed 2 new commits to master: http://git.io/ve306<br/>
<font color="#A82F2F"><font size="2">(06:56:59 AM)</font> <b>NixOS_GitHub:</b></font> (notice) nixpkgs/master 18c9619 William A. Kennington III: nvidia: Add beta driver<br/>
<font color="#A82F2F"><font size="2">(06:56:59 AM)</font> <b>NixOS_GitHub:</b></font> (notice) nixpkgs/master c0cb4e1 William A. Kennington III: nixos/nvidia: Add a temporary hack to support kernel 4.0<br/>
<font color="#A82F2F"><font size="2">(06:56:59 AM)</font> <b>NixOS_GitHub:</b></font> (notice) [nixpkgs] wkennington pushed 1 new commit to master: http://git.io/ve30M<br/>
<font color="#A82F2F"><font size="2">(06:56:59 AM)</font> <b>NixOS_GitHub:</b></font> (notice) nixpkgs/master 7552309 William A. Kennington III: gdk_pixbuf: 2.30.8 -&gt; 2.31.3<br/>
<font color="#A82F2F"><font size="2">(08:10:02 AM)</font> <b>NixOS_GitHub:</b></font> (notice) [nixpkgs] spwhitt opened pull request #7162: sl, astyle, uncrustify, mediainfo: Darwin fixes (master...simple_darwin_fixes) http://git.io/ve3wk<br/>
<font color="#A82F2F"><font size="2">(08:18:42 AM)</font> <b>NixOS_GitHub:</b></font> (notice) [nixpkgs] wkennington pushed 1 new commit to master: http://git.io/ve3rv<br/>
<font color="#A82F2F"><font size="2">(08:18:42 AM)</font> <b>NixOS_GitHub:</b></font> (notice) nixpkgs/master 43d114c William A. Kennington III: bundler-head: Fix hash<br/>
<font color="#A82F2F"><font size="2">(08:24:12 AM)</font> <b>NixOS_GitHub:</b></font> (notice) [nixpkgs] wkennington pushed 1 new commit to master: http://git.io/ve3rP<br/>
<font color="#A82F2F"><font size="2">(08:24:12 AM)</font> <b>NixOS_GitHub:</b></font> (notice) nixpkgs/master 445d789 William A. Kennington III: Fix some platforms<br/>
<font color="#A82F2F"><font size="2">(10:54:31 AM)</font> <b>ktosiek:</b></font> it looks like Hydra has problems with accessing ftp://xmlsoft.org/libxml2/libxslt-1.1.28.tar.gz - there are already 5 failed installer tests because of that, but I can download the file locally (and get the right output path)<br/>
