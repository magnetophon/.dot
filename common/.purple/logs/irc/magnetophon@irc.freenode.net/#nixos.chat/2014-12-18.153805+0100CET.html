<html><head><meta http-equiv="content-type" content="text/html; charset=UTF-8"><title>Conversation with #nixos at Thu 18 Dec 2014 03:38:05 PM CET on magnetophon@irc.freenode.net (irc)</title></head><body><h3>Conversation with #nixos at Thu 18 Dec 2014 03:38:05 PM CET on magnetophon@irc.freenode.net (irc)</h3>
<font size="2">(03:38:06 PM)</font><b> The topic for #nixos is: <a href="http://nixos.org/">http://nixos.org/</a> || Latest NixOS: <a href="http://nixos.org/nixos/download.html">http://nixos.org/nixos/download.html</a> || Latest Nix: <a href="http://nixos.org/nix/download.html">http://nixos.org/nix/download.html</a> || Logs: <a href="http://nixos.org/irc/logs/">http://nixos.org/irc/logs/</a> || Swag: <a href="http://www.cafepress.co.uk/NixOS">http://www.cafepress.co.uk/NixOS</a></b><br/>
<font size="2">(03:38:06 PM)</font><b> Topic for #nixos set by niksnut!~eelco@ec2-54-216-36-73.eu-west-1.compute.amazonaws.com at 12:56:59 PM on 04/11/2014</b><br/>
<font color="#A82F2F"><font size="2">(03:38:41 PM)</font> <b>aszlig:</b></font> Fuuzetsu: exactly that was the thing that was left to fix and for the vboxusers group: you should be able to use hostonlyifs and everything except usb without being a member of this group<br/>
<font size="2">(03:39:35 PM)</font><b> Takle_ [<em>~takle@2a00:fd00:fff1:5768:9873:364c:aabf:5302</em>] entered the room.</b><br/>
<font size="2">(03:42:17 PM)</font><b> henrytill left the room (quit: Quit: leaving).</b><br/>
<font size="2">(03:42:24 PM)</font><b> vizant0 [<em>~Adium@dhcp-089-098-191-095.chello.nl</em>] entered the room.</b><br/>
<font size="2">(03:43:03 PM)</font><b> Takle left the room (quit: Ping timeout: 244 seconds).</b><br/>
<font size="2">(03:43:36 PM)</font><b> henrytill [<em>~henrytill@unaffiliated/henrytill</em>] entered the room.</b><br/>
<font size="2">(03:45:43 PM)</font><b> vizant01 left the room (quit: Ping timeout: 255 seconds).</b><br/>
<font size="2">(03:48:59 PM)</font><b> dysinger [<em>~dysinger@cpe-24-94-75-243.hawaii.res.rr.com</em>] entered the room.</b><br/>
<font size="2">(03:52:28 PM)</font><b> Shados [<em>~shados@38.110.116.217</em>] entered the room.</b><br/>
<font color="#A82F2F"><font size="2">(03:56:36 PM)</font> <b>eddyb:</b></font> what&apos;s up with touchpad moving faster when my effective screen size is larger (external LCD is plugged in)?<br/>
<font color="#A82F2F"><font size="2">(03:56:44 PM)</font> <b>eddyb:</b></font> synclint reports the same values before/after<br/>
<font size="2">(03:57:45 PM)</font><b> suffering [<em>~suffering@cpe-72-227-184-166.nyc.res.rr.com</em>] entered the room.</b><br/>
<font color="#A82F2F"><font size="2">(03:58:19 PM)</font> <b>NixOS_GitHub:</b></font> (notice) [nixpkgs] iElectric pushed 1 new commit to release-14.12: http://git.io/XAdYTQ<br/>
<font color="#A82F2F"><font size="2">(03:58:19 PM)</font> <b>NixOS_GitHub:</b></font> (notice) nixpkgs/release-14.12 b57ea53 Eelco Dolstra: Fix container test...<br/>
<font size="2">(04:05:31 PM)</font><b> lucidd_ left the room (quit: Ping timeout: 255 seconds).</b><br/>
<font size="2">(04:07:21 PM)</font><b> suffering left the room (quit: Quit: My MacBook has gone to sleep. ZZZzzz…).</b><br/>
<font size="2">(04:08:05 PM)</font><b> mizu_no_oto [<em>~textual@gw1.mcgraw-hill.com</em>] entered the room.</b><br/>
<font color="#A82F2F"><font size="2">(04:08:54 PM)</font> <b>evangeline__:</b></font> Lethalman, hi, it&apos;s me again :) do you have any idea why xterm starts with every awesome desktop ... is there any way to disable that xterm, since I don&apos;t want to start it with awesome, any ideas ?<br/>
<font color="#A82F2F"><font size="2">(04:09:18 PM)</font> <b>evangeline__:</b></font> Lethalman, plus the login manager says &quot;Session: xterm + awesome&quot;, I would like &quot;Session: none + awesome&quot; ?<br/>
<font size="2">(04:09:50 PM)</font><b> evangeline__ left the room (quit: Read error: Connection reset by peer).</b><br/>
<font color="#A82F2F"><font size="2">(04:09:53 PM)</font> <b>Fuuzetsu:</b></font> evangeline__: services.xserver.desktopManager.default = &quot;none&quot;;<br/>
<font size="2">(04:10:32 PM)</font><b> Shados left the room (quit: Remote host closed the connection).</b><br/>
<font size="2">(04:10:42 PM)</font><b> Shados [<em>~shados@shados.net</em>] entered the room.</b><br/>
<font size="2">(04:12:02 PM)</font><b> evangeline__ [<em>~evangelin@93-103-107-74.dynamic.t-2.net</em>] entered the room.</b><br/>
<font size="2">(04:15:01 PM)</font><b> keeds [<em>~keeds@88-97-1-216.dsl.zen.co.uk</em>] entered the room.</b><br/>
<font size="2">(04:19:25 PM)</font><b> lucidd_ [<em>~lucid@HSI-KBW-078-042-152-111.hsi3.kabel-badenwuerttemberg.de</em>] entered the room.</b><br/>
<font color="#A82F2F"><font size="2">(04:25:33 PM)</font> <b>NixOS_GitHub:</b></font> (notice) [nixpkgs] bluescreen303 opened pull request #5388: nixos/qemu-vm: make networking options configurable (master...qemu-vm-networking) http://git.io/tvZYTw<br/>
<font size="2">(04:27:32 PM)</font><b> keeds left the room (quit: Ping timeout: 250 seconds).</b><br/>
<font size="2">(04:29:13 PM)</font><b> thawes left the room (quit: Ping timeout: 258 seconds).</b><br/>
<font size="2">(04:29:32 PM)</font><b> thawes [<em>~quassel@168.215.121.226</em>] entered the room.</b><br/>
<font size="2">(04:30:15 PM)</font><b> angerman left the room (quit: Quit: Gone).</b><br/>
<font size="2">(04:37:26 PM)</font><b> nslqqq1 [<em>~nsl@l37-194-49-51.novotelecom.ru</em>] entered the room.</b><br/>
<font size="2">(04:38:19 PM)</font><b> scounder left the room (quit: Changing host).</b><br/>
<font size="2">(04:38:22 PM)</font><b> scounder [<em>~scounder@unaffiliated/scounder</em>] entered the room.</b><br/>
<font size="2">(04:45:32 PM)</font><b> wmertens [<em>~wmertens@89-67-218-35.dynamic.chello.pl</em>] entered the room.</b><br/>
<font size="2">(04:46:04 PM)</font><b> pmahoney [<em>~user@50.56.229.7</em>] entered the room.</b><br/>
<font size="2">(04:46:37 PM)</font><b> bennofs [<em>~benno@ip92342b4f.dynamic.kabel-deutschland.de</em>] entered the room.</b><br/>
<font size="2">(04:50:04 PM)</font><b> keeds [<em>~keeds@88-97-1-216.dsl.zen.co.uk</em>] entered the room.</b><br/>
<font color="#A82F2F"><font size="2">(04:51:14 PM)</font> <b>the_scourge:</b></font> how can i install npm2nix without npm?<br/>
<font color="#A82F2F"><font size="2">(04:52:35 PM)</font> <b>pmahoney:</b></font> looking at bin/nix-channel (and nix/perl/lib/Nix/Config.pm.in), it seems nix-channel only allows http[s]:// urls (given the --head flag when downloading a channel), and does not import NIX_CURL_FLAGS<br/>
<font color="#A82F2F"><font size="2">(04:53:07 PM)</font> <b>pmahoney:</b></font> i conclude there is no way to secure a nix channel via sftp://, https:// with client cert, or http auth<br/>
<font color="#A82F2F"><font size="2">(04:55:05 PM)</font> <b>Fuuzetsu:</b></font> pretty sure https has been frequently discussed already<br/>
<font color="#A82F2F"><font size="2">(04:56:36 PM)</font> <b>pmahoney:</b></font> hm, actually for my needs it may be sufficient to have a secure binary cache, with the channel itself public (i have nix pkgs with source from private code repos)<br/>
<font color="#A82F2F"><font size="2">(04:56:54 PM)</font> <b>pmahoney:</b></font> Fuuzetsu: on the mailing list or github?  i&apos;ll search, thanks...<br/>
<font color="#A82F2F"><font size="2">(04:57:00 PM)</font> <b>Fuuzetsu:</b></font> pmahoney: IRC mostly<br/>
<font color="#A82F2F"><font size="2">(04:57:02 PM)</font> <b>pmahoney:</b></font> ah<br/>
<font color="#A82F2F"><font size="2">(04:57:12 PM)</font> <b>Fuuzetsu:</b></font> I think if you just stick around and make noise someone can pipe up<br/>
<font size="2">(04:58:24 PM)</font><b> ebzzry [<em>~ebzzry@112.204.28.97</em>] entered the room.</b><br/>
<font size="2">(05:02:15 PM)</font><b> ajhager [<em>~ajhager@99-8-18-142.lightspeed.iplsin.sbcglobal.net</em>] entered the room.</b><br/>
<font size="2">(05:06:54 PM)</font><b> rycee left the room (quit: Ping timeout: 256 seconds).</b><br/>
<font color="#A82F2F"><font size="2">(05:08:27 PM)</font> <b>aszlig:</b></font> okay, virtualbox tests for nixops passed as well<br/>
<font size="2">(05:08:47 PM)</font><b> rickynils left the room (quit: Remote host closed the connection).</b><br/>
<font color="#A82F2F"><font size="2">(05:11:56 PM)</font> <b>NixOS_GitHub:</b></font> (notice) [nixpkgs] bluescreen303 created qemu-vm-networking (+1 new commit): http://git.io/sznsow<br/>
<font color="#A82F2F"><font size="2">(05:11:56 PM)</font> <b>NixOS_GitHub:</b></font> (notice) nixpkgs/qemu-vm-networking 3798be0 Mathijs Kwik: nixos/qemu-vm: make networking options configurable<br/>
<font color="#A82F2F"><font size="2">(05:12:16 PM)</font> <b>NixOS_GitHub:</b></font> (notice) [nixpkgs] bluescreen303 deleted qemu-vm-networking at 3798be0: http://git.io/6SADcQ<br/>
<font size="2">(05:13:03 PM)</font><b> henrytill left the room (quit: Quit: leaving).</b><br/>
<font size="2">(05:13:52 PM)</font><b> henrytill [<em>~henrytill@unaffiliated/henrytill</em>] entered the room.</b><br/>
<font size="2">(05:17:47 PM)</font><b> theandy [<em>~textual@pool-71-104-192-236.lsanca.dsl-w.verizon.net</em>] entered the room.</b><br/>
<font size="2">(05:23:52 PM)</font><b> lucidd_ left the room (quit: Ping timeout: 250 seconds).</b><br/>
<font size="2">(05:28:26 PM)</font><b> bdimcheff [<em>~bdimcheff@c-68-43-21-181.hsd1.mi.comcast.net</em>] entered the room.</b><br/>
<font size="2">(05:28:51 PM)</font><b> keeds left the room (quit: Ping timeout: 272 seconds).</b><br/>
<font color="#A82F2F"><font size="2">(05:31:39 PM)</font> <b>shlevy:</b></font> niksnut: In systemd units whole sections can be prefixed with X- and ignored (and thus the contained options don&apos;t need the X-). Should we switch to an X-NixOS section?<br/>
<font size="2">(05:33:58 PM)</font><b> evangeline__ left the room (quit: Ping timeout: 265 seconds).</b><br/>
<font color="#A82F2F"><font size="2">(05:34:07 PM)</font> <b>niksnut:</b></font> shlevy: would have been nice if we done that from the beginning, but not much use in switching to that now<br/>
<font size="2">(05:36:20 PM)</font><b> lucidd_ [<em>~lucid@HSI-KBW-078-042-152-111.hsi3.kabel-badenwuerttemberg.de</em>] entered the room.</b><br/>
<font size="2">(05:37:05 PM)</font><b> nslqqq1 left the room (quit: Ping timeout: 272 seconds).</b><br/>
<font color="#A82F2F"><font size="2">(05:37:32 PM)</font> <b>shlevy:</b></font> Is there a hook for enabling ad-hoc non-configuration-maintained units?<br/>
<font color="#A82F2F"><font size="2">(05:38:14 PM)</font> <b>Lethalman:</b></font> shlevy, in the sense that you have a systemd service elsewhere?<br/>
<font color="#A82F2F"><font size="2">(05:38:58 PM)</font> <b>Lethalman:</b></font> but no maybe enable will install files in /etc/systemd/system still<br/>
<font color="#A82F2F"><font size="2">(05:39:08 PM)</font> <b>shlevy:</b></font> Lethalman: yes<br/>
<font color="#A82F2F"><font size="2">(05:39:29 PM)</font> <b>shlevy:</b></font> /etc/systemd/system is a store path :/<br/>
<font color="#A82F2F"><font size="2">(05:39:29 PM)</font> <b>Lethalman:</b></font> eh :P<br/>
<font color="#A82F2F"><font size="2">(05:41:14 PM)</font> <b>shlevy:</b></font> ugh<br/>
<font color="#A82F2F"><font size="2">(05:41:34 PM)</font> <b>shlevy:</b></font> So there&apos;s no way to load a unit automatically at boot without modifying the configuration and rebuilding<br/>
<font color="#A82F2F"><font size="2">(05:42:00 PM)</font> <b>shlevy:</b></font> Which means all service management has centralize at the configuration.nix bottleneck<br/>
<font color="#A82F2F"><font size="2">(05:42:22 PM)</font> <b>niksnut:</b></font> shlevy: sadly no<br/>
<font color="#A82F2F"><font size="2">(05:42:58 PM)</font> <b>niksnut:</b></font> the other day I was thinking about patching systemd to read units from /nix/var/nix/profiles/default/etc/systemd/system<br/>
<font color="#A82F2F"><font size="2">(05:43:05 PM)</font> <b>Lethalman:</b></font> just to confirm: systemctl enable will always insert files in the location of the service?<br/>
<font color="#A82F2F"><font size="2">(05:43:08 PM)</font> <b>niksnut:</b></font> and something similar for user units<br/>
<font color="#A82F2F"><font size="2">(05:43:09 PM)</font> <b>shlevy:</b></font> What about sysv init scripts?<br/>
<font color="#A82F2F"><font size="2">(05:43:09 PM)</font> <b>Lethalman:</b></font> not in the directory of the new service?<br/>
<font color="#A82F2F"><font size="2">(05:43:39 PM)</font> <b>shlevy:</b></font> niksnut: I&apos;m looking for a way to deploy services to a machine without any coordination with other deployments to that same machine<br/>
<font color="#A82F2F"><font size="2">(05:44:01 PM)</font> <b>niksnut:</b></font> you can put units in /run/systemd/system<br/>
<font color="#A82F2F"><font size="2">(05:44:08 PM)</font> <b>shlevy:</b></font> And on reboot?<br/>
<font color="#A82F2F"><font size="2">(05:44:19 PM)</font> <b>Lethalman:</b></font> shlevy, you can put also units in your /root directory I think<br/>
<font color="#A82F2F"><font size="2">(05:44:20 PM)</font> <b>niksnut:</b></font> they won&apos;t be persistent, but you could have a boot-time command to copy/link them there<br/>
<font color="#A82F2F"><font size="2">(05:44:31 PM)</font> <b>wmertens:</b></font> Anybody knowledgeable about php? I think https://github.com/NixOS/nixpkgs/pull/5383 should be applied and put in 14.12 as well but I&apos;m not sure of the breakage if any<br/>
<font color="#A82F2F"><font size="2">(05:44:33 PM)</font> <b>Lethalman:</b></font> look for search directories, I&apos;m sure you can put something under /root<br/>
<font color="#A82F2F"><font size="2">(05:44:37 PM)</font> <b>Lethalman:</b></font> but my concern is about [Install]<br/>
<font color="#A82F2F"><font size="2">(05:44:52 PM)</font> <b>shlevy:</b></font> Lethalman: Nope, there&apos;s only /etc/systemd/system, /run/systemd/system, and /usr/lib/systemd/system<br/>
<font color="#A82F2F"><font size="2">(05:44:55 PM)</font> <b>niksnut:</b></font> Lethalman: never heard of /root<br/>
<font color="#A82F2F"><font size="2">(05:44:57 PM)</font> <b>shlevy:</b></font> niksnut: Is that latter disabled on nixos?<br/>
<font color="#A82F2F"><font size="2">(05:45:01 PM)</font> <b>Lethalman:</b></font> wait<br/>
<font color="#A82F2F"><font size="2">(05:45:14 PM)</font> <b>Lethalman:</b></font> shlevy, niksnut http://www.freedesktop.org/software/systemd/man/systemd.unit.html<br/>
<font color="#A82F2F"><font size="2">(05:45:19 PM)</font> <b>Lethalman:</b></font> $HOME/.config/systemd/user/<br/>
<font color="#A82F2F"><font size="2">(05:45:24 PM)</font> <b>shlevy:</b></font> Lethalman: that&apos;s for systemd --usr<br/>
<font color="#A82F2F"><font size="2">(05:45:26 PM)</font> <b>shlevy:</b></font> user<br/>
<font color="#A82F2F"><font size="2">(05:45:43 PM)</font> <b>Lethalman:</b></font> I&apos;m sure I once ran some services I had under /root<br/>
<font color="#A82F2F"><font size="2">(05:45:55 PM)</font> <b>niksnut:</b></font> shlevy: I don&apos;t think so, but best not to rely on that<br/>
<font size="2">(05:46:15 PM)</font><b> MichaelRaskin left the room (quit: Quit: MichaelRaskin).</b><br/>
<font color="#A82F2F"><font size="2">(05:46:40 PM)</font> <b>Lethalman:</b></font> there&apos;s systemctl --root<br/>
<font color="#A82F2F"><font size="2">(05:47:03 PM)</font> <b>shlevy:</b></font> niksnut: strong objection to a mutableSystemdConfig option? So that /etc/systemd/system and the various .wants directories are persistent + writable?<br/>
<font color="#A82F2F"><font size="2">(05:47:24 PM)</font> <b>shlevy:</b></font> niksnut: With that we get the same behavior on NixOS as other systemd systems<br/>
<font color="#A82F2F"><font size="2">(05:47:36 PM)</font> <b>wmertens:</b></font> Lethalman: might have been $XDG_DATA_HOME/systemd/user	Units of packages that have been installed in the home directory (only used when $XDG_DATA_HOME is set)?<br/>
<font color="#A82F2F"><font size="2">(05:47:38 PM)</font> <b>shlevy:</b></font> niksnut: any idea about sysvinit scripts?<br/>
<font color="#A82F2F"><font size="2">(05:47:47 PM)</font> <b>Lethalman:</b></font> wmertens, that&apos;s still /user<br/>
<font color="#A82F2F"><font size="2">(05:47:50 PM)</font> <b>niksnut:</b></font> shlevy: well, that pretty much goes against the declarative approach<br/>
<font color="#A82F2F"><font size="2">(05:47:56 PM)</font> <b>Lethalman:</b></font> but I think I once ran some service with systemctl --root<br/>
<font size="2">(05:48:00 PM)</font><b> Takle_ left the room (quit: Remote host closed the connection).</b><br/>
<font color="#A82F2F"><font size="2">(05:48:01 PM)</font> <b>Lethalman:</b></font> maybe not with [Install] though<br/>
<font size="2">(05:48:05 PM)</font><b> dannyg left the room.</b><br/>
<font color="#A82F2F"><font size="2">(05:48:07 PM)</font> <b>niksnut:</b></font> and it can be accomplished using /run/systemd/system in any case<br/>
<font color="#A82F2F"><font size="2">(05:48:21 PM)</font> <b>Lethalman:</b></font> niksnut, no, what about systemctl enable?<br/>
<font color="#A82F2F"><font size="2">(05:48:26 PM)</font> <b>shlevy:</b></font> niksnut: Not persistently...<br/>
<font color="#A82F2F"><font size="2">(05:48:31 PM)</font> <b>niksnut:</b></font> Lethalman: what about it?<br/>
<font color="#A82F2F"><font size="2">(05:48:33 PM)</font> <b>Lethalman:</b></font> shlevy, what about the next nixos-rebuild switch? wont /etc/systemd/system be wiped?<br/>
<font size="2">(05:48:34 PM)</font><b> Takle [<em>~takle@2a00:fd00:fff1:5768:9873:364c:aabf:5302</em>] entered the room.</b><br/>
<font color="#A82F2F"><font size="2">(05:48:45 PM)</font> <b>Lethalman:</b></font> niksnut, doesn&apos;t systemd install files in /etc/systemd/system if you have [Install] ?<br/>
<font color="#A82F2F"><font size="2">(05:48:51 PM)</font> <b>Lethalman:</b></font> niksnut, for .requires and .wants<br/>
<font color="#A82F2F"><font size="2">(05:49:05 PM)</font> <b>niksnut:</b></font> Lethalman: there are a bunch of systemd commands that we should really disable<br/>
<font color="#A82F2F"><font size="2">(05:49:07 PM)</font> <b>shlevy:</b></font> Lethalman: Well the idea would be that nixos-maintained services would be overwritten but the rest would stay<br/>
<font color="#A82F2F"><font size="2">(05:49:10 PM)</font> <b>shlevy:</b></font> Anyway<br/>
<font color="#A82F2F"><font size="2">(05:49:13 PM)</font> <b>niksnut:</b></font> like enable/disable<br/>
<font color="#A82F2F"><font size="2">(05:49:20 PM)</font> <b>Lethalman:</b></font> niksnut, don&apos;t know if I&apos;m explaining myself so bad<br/>
<font color="#A82F2F"><font size="2">(05:49:23 PM)</font> <b>NixOS_GitHub:</b></font> (notice) [nixpkgs] wmertens closed pull request #5383: php: make curl wrappers optional (master...tmp1) http://git.io/7OMKTA<br/>
<font color="#A82F2F"><font size="2">(05:49:39 PM)</font> <b>shlevy:</b></font> AFAICT there&apos;s no way to run a service on boot without modifying the configuration, which sucks<br/>
<font color="#A82F2F"><font size="2">(05:49:43 PM)</font> <b>Lethalman:</b></font> niksnut, if you put a service under /run that has an [Install] and you want to enable it otherwise you don&apos;t get it started at boot for example, how do you do that<br/>
<font color="#A82F2F"><font size="2">(05:50:04 PM)</font> <b>Lethalman:</b></font> if you don&apos;t do systemctl enable it won&apos;t be e.g. required by multi-user.target<br/>
<font color="#A82F2F"><font size="2">(05:50:07 PM)</font> <b>shlevy:</b></font> And any solution that involves copying files to /run on boot will be NixoS-specific<br/>
<font color="#A82F2F"><font size="2">(05:50:35 PM)</font> <b>shlevy:</b></font> If sysvinit scripts work that could be enough<br/>
<font color="#A82F2F"><font size="2">(05:50:48 PM)</font> <b>shlevy:</b></font> Just make something in /etc/init.d that copies the units to /run and enables them<br/>
<font color="#A82F2F"><font size="2">(05:50:57 PM)</font> <b>niksnut:</b></font> I wouldn&apos;t rely on sysvinit scripts either, they&apos;re legacy that we don&apos;t really want to support on NixOS<br/>
<font color="#A82F2F"><font size="2">(05:51:08 PM)</font> <b>shlevy:</b></font> OK<br/>
<font color="#A82F2F"><font size="2">(05:51:31 PM)</font> <b>shlevy:</b></font> So there&apos;s no way on a vanilla nixos to do this. We have to have custom configs.<br/>
<font size="2">(05:51:49 PM)</font><b> erasmas [<em>~erasmas@66.237.6.57</em>] entered the room.</b><br/>
<font color="#A82F2F"><font size="2">(05:51:52 PM)</font> <b>shlevy:</b></font> That&apos;s really frustrating, and even with the custom configs we&apos;ll have to special case NixOS vs other systemd-running distros<br/>
<font size="2">(05:52:00 PM)</font><b> sigmundv [<em>~sigmundv@178.167.254.42.threembb.ie</em>] entered the room.</b><br/>
<font color="#A82F2F"><font size="2">(05:52:42 PM)</font> <b>Lethalman:</b></font> shlevy, I think it&apos;s also systemd to blame, because it uses those stupid .wants directories<br/>
<font color="#A82F2F"><font size="2">(05:52:43 PM)</font> <b>niksnut:</b></font> shlevy: yes, NixOS has a different configuration model than other distros<br/>
<font size="2">(05:53:01 PM)</font><b> stepcut left the room (quit: Quit: suicide is painless.).</b><br/>
<font color="#A82F2F"><font size="2">(05:53:02 PM)</font> <b>wmertens:</b></font> shlevy: couldn&apos;t you use readdir to import configs that you put somewhere?<br/>
<font size="2">(05:53:10 PM)</font><b> Takle left the room (quit: Ping timeout: 258 seconds).</b><br/>
<font color="#A82F2F"><font size="2">(05:53:34 PM)</font> <b>shlevy:</b></font> Lethalman: Even without those it would still be a problem. /run is ephemeral<br/>
<font color="#A82F2F"><font size="2">(05:53:35 PM)</font> <b>shlevy:</b></font> wmertens: ?<br/>
<font color="#A82F2F"><font size="2">(05:53:48 PM)</font> <b>Lethalman:</b></font> shlevy, yet a stupidity of systemd, instead of making those directories configurable<br/>
<font color="#A82F2F"><font size="2">(05:54:22 PM)</font> <b>niksnut:</b></font> shlevy: this is like complaining that you can&apos;t just copy a binary to /usr/bin and have it work on NixOS and non-NixOS<br/>
<font color="#A82F2F"><font size="2">(05:54:26 PM)</font> <b>wmertens:</b></font> shlevy: *handwave handwave* treat all systemd servers the same but update nix with a module that imports what you uploaded there somehow<br/>
<font color="#A82F2F"><font size="2">(05:54:58 PM)</font> <b>shlevy:</b></font> niksnut: No it&apos;s not, because I can upload a nix binary anywhere and have it work on NixOS and non-NixOS<br/>
<font color="#A82F2F"><font size="2">(05:55:04 PM)</font> <b>shlevy:</b></font> There&apos;s *no* way on vanilla nixos to do this at all<br/>
<font color="#A82F2F"><font size="2">(05:55:51 PM)</font> <b>shlevy:</b></font> And since you&apos;re ruling out /usr/lib/systemd/system and /etc/init.d, there&apos;s no way to have something that works generically at all<br/>
<font color="#A82F2F"><font size="2">(05:57:00 PM)</font> <b>niksnut:</b></font> I told you already that you can. Just have a system.activationScripts.copyUnits = &quot;ln /my-dynamic-units/*.service /run/systemd/system/&quot; or something like that<br/>
<font color="#A82F2F"><font size="2">(05:57:23 PM)</font> <b>Lethalman:</b></font> niksnut, but it won&apos;t be started at boot<br/>
<font color="#A82F2F"><font size="2">(05:57:25 PM)</font> <b>wmertens:</b></font> ah yes, that&apos;s what I meant :-)<br/>
<font size="2">(05:57:30 PM)</font><b> stepcut [<em>~stepcut@c-24-14-39-248.hsd1.il.comcast.net</em>] entered the room.</b><br/>
<font color="#A82F2F"><font size="2">(05:57:47 PM)</font> <b>shlevy:</b></font> Lethalman: I think you can do a multi-user.wants in /run/systemd/system<br/>
<font color="#A82F2F"><font size="2">(05:58:04 PM)</font> <b>Lethalman:</b></font> shlevy, ah if systemd reads that then it&apos;s solved<br/>
<font color="#A82F2F"><font size="2">(05:58:27 PM)</font> <b>wmertens:</b></font> Lethalman: it will be started at boot, after activation, no?<br/>
<font color="#A82F2F"><font size="2">(05:58:32 PM)</font> <b>niksnut:</b></font> yeah, I&apos;m not sure if multi-user.wants get merged, but I would guess so<br/>
<font color="#A82F2F"><font size="2">(05:58:33 PM)</font> <b>shlevy:</b></font> niksnut: Sure, but that means we can&apos;t use a fresh upstream NixOS image, we have to have a custom image<br/>
<font color="#A82F2F"><font size="2">(05:58:48 PM)</font> <b>shlevy:</b></font> That&apos;s my point about &quot;vanilla nixos&quot;<br/>
<font color="#A82F2F"><font size="2">(05:59:01 PM)</font> <b>shlevy:</b></font> I can&apos;t ssh into a freshly built machine and get this working without a rebuild<br/>
<font color="#A82F2F"><font size="2">(05:59:09 PM)</font> <b>wmertens:</b></font> shlevy: is activating so costly?<br/>
<font color="#A82F2F"><font size="2">(05:59:20 PM)</font> <b>Lethalman:</b></font> shlevy, patch systemd to look into another directory :P<br/>
<font color="#A82F2F"><font size="2">(05:59:26 PM)</font> <b>Lethalman:</b></font> shlevy, for example it looks under /usr/... etc.<br/>
<font color="#A82F2F"><font size="2">(05:59:35 PM)</font> <b>Lethalman:</b></font> /usr/lib/systemd/system/*<br/>
<font color="#A82F2F"><font size="2">(05:59:35 PM)</font> <b>shlevy:</b></font> Lethalman: And niksnut told me not to rely on it :D<br/>
<font color="#A82F2F"><font size="2">(05:59:38 PM)</font> <b>Lethalman:</b></font> lol<br/>
<font color="#A82F2F"><font size="2">(05:59:48 PM)</font> <b>Lethalman:</b></font> shlevy, ofc, what do you expect from him<br/>
<font color="#A82F2F"><font size="2">(05:59:51 PM)</font> <b>Lethalman:</b></font> :P<br/>
<font color="#A82F2F"><font size="2">(06:00:03 PM)</font> <b>shlevy:</b></font> If we could have something like /var/lib/systemd/nondeclarative-units<br/>
<font color="#062585"><font size="2">(06:00:03 PM)</font> <b>***Lethalman</b></font> now imagining niksnut patching systemd to remove that directory<br/>
<font color="#A82F2F"><font size="2">(06:00:18 PM)</font> <b>shlevy:</b></font> So if you put stuff there it&apos;s your own damn fault<br/>
<font color="#A82F2F"><font size="2">(06:00:18 PM)</font> <b>niksnut:</b></font> btw, I&apos;m not opposed to making /etc/systemd/system a directory rather than a static symlink<br/>
<font color="#A82F2F"><font size="2">(06:00:27 PM)</font> <b>shlevy:</b></font> But it just works out of the box<br/>
<font color="#A82F2F"><font size="2">(06:00:34 PM)</font> <b>Lethalman:</b></font> niksnut, that&apos;s evil<br/>
<font color="#A82F2F"><font size="2">(06:00:36 PM)</font> <b>shlevy:</b></font> that&apos;d be nice (but still require special casing, but that&apos;s easy enough)<br/>
<font color="#A82F2F"><font size="2">(06:00:40 PM)</font> <b>shlevy:</b></font> niksnut: Ah I thought you were<br/>
<font color="#A82F2F"><font size="2">(06:00:42 PM)</font> <b>niksnut:</b></font> but that&apos;s a bit complicated due to the way the units get generated<br/>
<font color="#A82F2F"><font size="2">(06:00:45 PM)</font> <b>Lethalman:</b></font> niksnut, how many times would you leave or replace files on nixos-rebuild<br/>
<font color="#A82F2F"><font size="2">(06:00:46 PM)</font> <b>Lethalman:</b></font> etc.<br/>
<font color="#A82F2F"><font size="2">(06:00:52 PM)</font> <b>Fuuzetsu:</b></font> shlevy: you don&apos;t happen to know if you can pass extra nix flags to upcast (such as --fallback) do you?<br/>
<font color="#A82F2F"><font size="2">(06:00:54 PM)</font> <b>Lethalman:</b></font> it&apos;s very evil<br/>
<font color="#A82F2F"><font size="2">(06:00:55 PM)</font> <b>niksnut:</b></font> Lethalman: well, only evil if you use it :p<br/>
<font color="#A82F2F"><font size="2">(06:01:09 PM)</font> <b>niksnut:</b></font> stuff like /etc/pam.d is also just a directory<br/>
<font color="#A82F2F"><font size="2">(06:01:14 PM)</font> <b>shlevy:</b></font> Fuuzetsu: I don&apos;t know off the top of my head<br/>
<font color="#A82F2F"><font size="2">(06:01:19 PM)</font> <b>Fuuzetsu:</b></font> oks<br/>
<font color="#A82F2F"><font size="2">(06:01:37 PM)</font> <b>Lethalman:</b></font> niksnut, uhm that&apos;s not atomic, is it?<br/>
<font color="#A82F2F"><font size="2">(06:01:40 PM)</font> <b>aszlig:</b></font> shlevy: what about systemd.unit=foo as a kopt?<br/>
<font color="#A82F2F"><font size="2">(06:01:49 PM)</font> <b>Lethalman:</b></font> well many things in /etc are not atomic<br/>
<font color="#A82F2F"><font size="2">(06:01:55 PM)</font> <b>shlevy:</b></font> niksnut: So if I implemented it so that /etc/systemd/system{,*.{wants,requires,.d}} were all modifiable?<br/>
<font color="#A82F2F"><font size="2">(06:02:00 PM)</font> <b>shlevy:</b></font> niksnut: That&apos;d be OK?<br/>
<font color="#A82F2F"><font size="2">(06:02:05 PM)</font> <b>shlevy:</b></font> aszlig: kopt?<br/>
<font color="#A82F2F"><font size="2">(06:02:14 PM)</font> <b>aszlig:</b></font> never mind, that would imply that the unit is already there<br/>
<font color="#A82F2F"><font size="2">(06:02:18 PM)</font> <b>niksnut:</b></font> Lethalman: the atomicity is probably not an issue, because they all get reloaded on systemctl daemon-reload<br/>
<font color="#A82F2F"><font size="2">(06:02:20 PM)</font> <b>shlevy:</b></font> Lethalman: check out the logic about /etc/static<br/>
<font color="#A82F2F"><font size="2">(06:02:24 PM)</font> <b>Lethalman:</b></font> shlevy, you would get them replaced on next nixos-rebuild I guess<br/>
<font color="#A82F2F"><font size="2">(06:02:34 PM)</font> <b>aszlig:</b></font> kernel option<br/>
<font color="#A82F2F"><font size="2">(06:02:36 PM)</font> <b>Lethalman:</b></font> shlevy, that&apos;s not easy, as you don&apos;t have the previous state of nixos in those directories<br/>
<font color="#A82F2F"><font size="2">(06:02:51 PM)</font> <b>aaronlevin:</b></font> is anyone else getting failures trying to build `xz`? I&apos;m seeing &quot;curl: (6) Couldn&apos;t resolve host &apos;tukaani.org&apos;&quot;<br/>
<font color="#A82F2F"><font size="2">(06:02:56 PM)</font> <b>Lethalman:</b></font> so which file do you delete from a .wants directory?<br/>
<font color="#A82F2F"><font size="2">(06:02:59 PM)</font> <b>wmertens:</b></font> shlevy niksnut Lethalman actually if we promise not to patch systemd to remove the /usr/lib one, it&apos;s a solved problem?<br/>
<font color="#A82F2F"><font size="2">(06:03:06 PM)</font> <b>aaronlevin:</b></font> this is the url it&apos;s trying to get:  http://tukaani.org/xz/xz-5.0.7.tar.bz2<br/>
<font color="#A82F2F"><font size="2">(06:03:09 PM)</font> <b>shlevy:</b></font> wmertens: Solves it for me<br/>
<font color="#A82F2F"><font size="2">(06:03:11 PM)</font> <b>niksnut:</b></font> shlevy: I don&apos;t know, if they&apos;re also directories, then it might cause problems if a unit is removed from the config<br/>
<font color="#A82F2F"><font size="2">(06:03:21 PM)</font> <b>aaronlevin:</b></font> I see this issue locally and when I run this on Google Compute Engine.<br/>
<font color="#A82F2F"><font size="2">(06:03:26 PM)</font> <b>niksnut:</b></font> because I don&apos;t think our etc-handling code removes directories<br/>
<font color="#A82F2F"><font size="2">(06:03:32 PM)</font> <b>shlevy:</b></font> niksnut: IMO we really need a concept of &quot;handing off&quot; from the previous active config<br/>
<font color="#A82F2F"><font size="2">(06:03:35 PM)</font> <b>Lethalman:</b></font> making /etc/systemd/system a directory is a mess, you don&apos;t know the previous state<br/>
<font color="#A82F2F"><font size="2">(06:03:35 PM)</font> <b>niksnut:</b></font> so &lt;obsolete&gt;.wants might stay around<br/>
<font color="#A82F2F"><font size="2">(06:03:57 PM)</font> <b>Lethalman:</b></font> shlevy, it&apos;s easier to have a mutable directory elsewhere rather than this mess, honestly<br/>
<font color="#A82F2F"><font size="2">(06:04:16 PM)</font> <b>Lethalman:</b></font> shlevy, and having the previous state of nixos makes things less idempotent<br/>
<font color="#A82F2F"><font size="2">(06:04:19 PM)</font> <b>wmertens:</b></font> aaronlevin: I can download that file<br/>
<font color="#A82F2F"><font size="2">(06:04:39 PM)</font> <b>Fuuzetsu:</b></font> yes, file is fine for me<br/>
<font color="#A82F2F"><font size="2">(06:04:41 PM)</font> <b>aaronlevin:</b></font> @wmertens: i can download the file locally using wget as well.<br/>
<font color="#A82F2F"><font size="2">(06:04:41 PM)</font> <b>shlevy:</b></font> Lethalman: Sure. I&apos;d prefer /usr/lib/systemd/system (even though that&apos;s semantically incorrect) or having a nixos-specific place that gets copied to /run on boot<br/>
<font color="#A82F2F"><font size="2">(06:04:54 PM)</font> <b>Fuuzetsu:</b></font> aaronlevin: try nix-prefetch-url manually perhaps<br/>
<font color="#A82F2F"><font size="2">(06:05:00 PM)</font> <b>shlevy:</b></font> Lethalman: We already have this problem, as long as /etc isn&apos;t completely static<br/>
<font color="#A82F2F"><font size="2">(06:05:24 PM)</font> <b>niksnut:</b></font> shlevy: how about /etc/systemd-nixos (for NixOS-generated stuff) and /etc/systemd (for mutable stuff)<br/>
<font color="#A82F2F"><font size="2">(06:05:31 PM)</font> <b>Lethalman:</b></font> shlevy, with mutableUsers /etc should be straight a symlink I guess<br/>
<font color="#A82F2F"><font size="2">(06:05:33 PM)</font> <b>shlevy:</b></font> niksnut: +1!<br/>
<font color="#A82F2F"><font size="2">(06:05:36 PM)</font> <b>Lethalman:</b></font> *mutableUsers = false<br/>
<font color="#A82F2F"><font size="2">(06:05:38 PM)</font> <b>wmertens:</b></font> aaronlevin: https://github.com/NixOS/nixpkgs/issues/5337<br/>
<font color="#A82F2F"><font size="2">(06:05:47 PM)</font> <b>shlevy:</b></font> Lethalman: mtab, resolv...<br/>
<font color="#A82F2F"><font size="2">(06:05:52 PM)</font> <b>Lethalman:</b></font> shlevy, mtab is a symlink<br/>
<font color="#A82F2F"><font size="2">(06:05:53 PM)</font> <b>niksnut:</b></font> that will solve the issue that /etc/systemd isn&apos;t supposed to be used by the distro<br/>
<font color="#A82F2F"><font size="2">(06:06:10 PM)</font> <b>Lethalman:</b></font> shlevy, resolv could be a symlink elsewhere in /run<br/>
<font color="#A82F2F"><font size="2">(06:06:19 PM)</font> <b>shlevy:</b></font> niksnut: And we can mask systemctl enable by default but let people install it if theyw ant perhaps<br/>
<font color="#A82F2F"><font size="2">(06:06:26 PM)</font> <b>shlevy:</b></font> Lethalman: fair enough<br/>
<font color="#A82F2F"><font size="2">(06:06:42 PM)</font> <b>aszlig:</b></font> Fuuzetsu, iElectric: okay, tested even usb support now and everything works so far in hardened mode<br/>
<font color="#A82F2F"><font size="2">(06:06:48 PM)</font> <b>wmertens:</b></font> niksnut: actually the nixos units could live under /usr/lib/systemd/system<br/>
<font color="#A82F2F"><font size="2">(06:06:54 PM)</font> <b>aszlig:</b></font> any objections against making it default now?<br/>
<font color="#A82F2F"><font size="2">(06:06:56 PM)</font> <b>aaronlevin:</b></font> wmertens: thanks. how long does this usually take to get into a channel I can reference (e.g. nixpkgs-15.05prexxxxxx)?<br/>
<font color="#A82F2F"><font size="2">(06:07:06 PM)</font> <b>niksnut:</b></font> wmertens: yeah, but I don&apos;t want to have a /usr<br/>
<font color="#A82F2F"><font size="2">(06:07:07 PM)</font> <b>Fuuzetsu:</b></font> aszlig: none from me, seems to work fine<br/>
<font color="#A82F2F"><font size="2">(06:07:11 PM)</font> <b>niksnut:</b></font> we have code to handle /etc, not /usr<br/>
<font color="#A82F2F"><font size="2">(06:07:15 PM)</font> <b>aaronlevin:</b></font> wmertens: (this being the fix edolstra authored a day ago)<br/>
<font color="#A82F2F"><font size="2">(06:07:17 PM)</font> <b>wmertens:</b></font> niksnut: but we have /usr/bin/env?<br/>
<font color="#A82F2F"><font size="2">(06:07:18 PM)</font> <b>shlevy:</b></font> wmertens: IMO nixos shouldn&apos;t touch /usr by default beyond /usr/bin/env, but pointing systemd to /run/current-system/sw/lib/systemd/system works<br/>
<font color="#A82F2F"><font size="2">(06:07:22 PM)</font> <b>niksnut:</b></font> wmertens: in an ad-hoc way<br/>
<font color="#A82F2F"><font size="2">(06:07:39 PM)</font> <b>wmertens:</b></font> niksnut: oh and it can&apos;t be a symlink of course. grrr.<br/>
<font size="2">(06:08:04 PM)</font><b> mizu_no_oto left the room (quit: Quit: [&quot;Textual IRC Client: www.textualapp.com&quot;]).</b><br/>
<font color="#A82F2F"><font size="2">(06:08:08 PM)</font> <b>shlevy:</b></font> niksnut: Any reason it has to be in /etc at all? Why not /run/current-system?<br/>
<font color="#A82F2F"><font size="2">(06:08:20 PM)</font> <b>iElectric:</b></font> too much patching<br/>
<font color="#A82F2F"><font size="2">(06:08:26 PM)</font> <b>Lethalman:</b></font> iElectric, never enough!<br/>
<font color="#A82F2F"><font size="2">(06:08:36 PM)</font> <b>shlevy:</b></font> We already have to patch it if we&apos;re talking about /etc/systemd-NixOS or whatever<br/>
<font color="#A82F2F"><font size="2">(06:08:50 PM)</font> <b>Lethalman:</b></font> bleh what&apos;s that camelcase :P<br/>
<font color="#A82F2F"><font size="2">(06:09:03 PM)</font> <b>shlevy:</b></font> Ah sorry /etc/SystemD-NixOS<br/>
<font color="#A82F2F"><font size="2">(06:09:51 PM)</font> <b>wmertens:</b></font> aaronlevin: try installing curl from here http://hydra.nixos.org/build/17491837 ?<br/>
<font color="#A82F2F"><font size="2">(06:10:19 PM)</font> <b>niksnut:</b></font> shlevy: yeah, that would probably also work<br/>
<font color="#A82F2F"><font size="2">(06:10:24 PM)</font> <b>wmertens:</b></font> shlevy: /Etc/SystemD-NixOS ftfy<br/>
<font color="#A82F2F"><font size="2">(06:10:39 PM)</font> <b>shlevy:</b></font> niksnut: OK, I&apos;ll work up a patch for /run/current-system/systemd or whatever<br/>
<font color="#A82F2F"><font size="2">(06:11:02 PM)</font> <b>shlevy:</b></font> And then /etc/systemd should be free again right?<br/>
<font color="#A82F2F"><font size="2">(06:11:34 PM)</font> <b>niksnut:</b></font> well, /etc/systemd/{system,user}<br/>
<font color="#A82F2F"><font size="2">(06:11:38 PM)</font> <b>niksnut:</b></font> there is other stuff there<br/>
<font color="#A82F2F"><font size="2">(06:11:44 PM)</font> <b>shlevy:</b></font> Ah sure<br/>
<font color="#A82F2F"><font size="2">(06:12:49 PM)</font> <b>niksnut:</b></font> otoh, we should probably think about whether this doesn&apos;t make imperative configuration management too easy<br/>
<font color="#A82F2F"><font size="2">(06:13:07 PM)</font> <b>niksnut:</b></font> i.e. &quot;just run systemctl enable&quot;, &quot;just copy a file to /etc/system/...&quot;, &quot;just edit /etc/system/bla.conf&quot;<br/>
<font color="#A82F2F"><font size="2">(06:13:17 PM)</font> <b>shlevy:</b></font> Mm<br/>
<font color="#A82F2F"><font size="2">(06:13:20 PM)</font> <b>aaronlevin:</b></font> wmertens: thanks. trying now.<br/>
<font color="#A82F2F"><font size="2">(06:13:45 PM)</font> <b>shlevy:</b></font> I&apos;m in favor of disabling systemctl enable at least<br/>
<font color="#A82F2F"><font size="2">(06:14:00 PM)</font> <b>shlevy:</b></font> But fair enough<br/>
<font color="#A82F2F"><font size="2">(06:14:09 PM)</font> <b>niksnut:</b></font> so this might be an argument for adding a /etc/systemd-dynamic instead<br/>
<font color="#A82F2F"><font size="2">(06:14:39 PM)</font> <b>shlevy:</b></font> /etc/systemd-undeclarative-only-modify-me-if-you&apos;re-sure<br/>
<font color="#A82F2F"><font size="2">(06:14:40 PM)</font> <b>niksnut:</b></font> to make it clear to one *is* bypassing the regular mechanisms<br/>
<font color="#A82F2F"><font size="2">(06:14:53 PM)</font> <b>niksnut:</b></font> *that<br/>
<font size="2">(06:15:01 PM)</font><b> theandy left the room (quit: Quit: My Mac has gone to sleep. ZZZzzz…).</b><br/>
<font color="#A82F2F"><font size="2">(06:15:16 PM)</font> <b>niksnut:</b></font> this will also be easier (probably a one-line patch to systemd)<br/>
<font color="#A82F2F"><font size="2">(06:15:22 PM)</font> <b>shlevy:</b></font> Mm yeah<br/>
<font color="#A82F2F"><font size="2">(06:15:23 PM)</font> <b>shlevy:</b></font> OK<br/>
<font color="#A82F2F"><font size="2">(06:15:27 PM)</font> <b>niksnut:</b></font> and no changes to NixOS<br/>
<font color="#A82F2F"><font size="2">(06:15:39 PM)</font> <b>shlevy:</b></font> And then I&apos;ll just switch off of /etc/NIXOS<br/>
<font color="#A82F2F"><font size="2">(06:15:40 PM)</font> <b>Lethalman:</b></font> niksnut, but then deployments system may need to change the directory<br/>
<font color="#A82F2F"><font size="2">(06:15:54 PM)</font> <b>niksnut:</b></font> shlevy: /etc/os-release, /etc/NIXOS is deprecated :p<br/>
<font color="#A82F2F"><font size="2">(06:16:01 PM)</font> <b>shlevy:</b></font> OK :)<br/>
<font color="#A82F2F"><font size="2">(06:16:11 PM)</font> <b>shlevy:</b></font> /etc/os-release ID field I suppose?<br/>
<font color="#A82F2F"><font size="2">(06:16:29 PM)</font> <b>niksnut:</b></font> Byeah<br/>
<font color="#A82F2F"><font size="2">(06:16:32 PM)</font> <b>niksnut:</b></font> *yeah<br/>
<font color="#A82F2F"><font size="2">(06:16:33 PM)</font> <b>shlevy:</b></font> OK<br/>
<font color="#A82F2F"><font size="2">(06:17:21 PM)</font> <b>niksnut:</b></font> maybe just patch /usr/lib/systemd to /etc/systemd-dynamic<br/>
<font color="#A82F2F"><font size="2">(06:17:29 PM)</font> <b>shlevy:</b></font> yep<br/>
<font color="#A82F2F"><font size="2">(06:17:32 PM)</font> <b>shlevy:</b></font> I&apos;ll go for that<br/>
<font size="2">(06:17:41 PM)</font><b> wscott left the room (&quot;Leaving&quot;).</b><br/>
<font color="#A82F2F"><font size="2">(06:18:03 PM)</font> <b>NixOS_GitHub:</b></font> (notice) [nixpkgs] vcunat pushed 1 new commit to master: http://git.io/0aDuSQ<br/>
<font color="#A82F2F"><font size="2">(06:18:03 PM)</font> <b>NixOS_GitHub:</b></font> (notice) nixpkgs/master 06e6d7d Sebastián Bernardo Galkin: xorg-server: enable DRI3 (close #5381)...<br/>
<font color="#A82F2F"><font size="2">(06:18:03 PM)</font> <b>Lethalman:</b></font> shlevy, but then won&apos;t you need to patch your deployments based on nixos/non-nixos?<br/>
<font color="#A82F2F"><font size="2">(06:18:08 PM)</font> <b>Lethalman:</b></font> that&apos;s more ugly honestly<br/>
<font color="#A82F2F"><font size="2">(06:18:20 PM)</font> <b>shlevy:</b></font> Lethalman: Yeah, switching off of /etc/os-release :)<br/>
<font color="#A82F2F"><font size="2">(06:18:23 PM)</font> <b>Lethalman:</b></font> easier but ugly<br/>
<font color="#A82F2F"><font size="2">(06:18:30 PM)</font> <b>shlevy:</b></font> Eh<br/>
<font size="2">(06:18:37 PM)</font><b> wmertens left the room (quit: Ping timeout: 240 seconds).</b><br/>
<font color="#A82F2F"><font size="2">(06:18:38 PM)</font> <b>shlevy:</b></font> It works<br/>
<font color="#A82F2F"><font size="2">(06:18:49 PM)</font> <b>shlevy:</b></font> And NixOS is a very special case<br/>
<font color="#A82F2F"><font size="2">(06:19:18 PM)</font> <b>NixOS_GitHub:</b></font> (notice) [nixpkgs] aszlig pushed 1 new commit to master: http://git.io/9NHrOQ<br/>
<font color="#A82F2F"><font size="2">(06:19:18 PM)</font> <b>NixOS_GitHub:</b></font> (notice) nixpkgs/master f7384b8 aszlig: nixos/virtualbox: Revert disable hardening....<br/>
<font color="#A82F2F"><font size="2">(06:20:14 PM)</font> <b>shlevy:</b></font> tv: Wanna test hardened vbox again? ^ :)<br/>
<font color="#A82F2F"><font size="2">(06:20:21 PM)</font> <b>aszlig:</b></font> iElectric: i&apos;m leaving this in master until some more people have tested it<br/>
<font size="2">(06:20:23 PM)</font><b> wmertens [<em>~wmertens@89-67-218-35.dynamic.chello.pl</em>] entered the room.</b><br/>
<font color="#A82F2F"><font size="2">(06:21:06 PM)</font> <b>aszlig:</b></font> tv: please do :-) and don&apos;t forget to remove your user from the vboxusers group if you don&apos;t use usb support<br/>
<font size="2">(06:21:09 PM)</font><b> bb010g left the room (quit: Quit: Connection closed for inactivity).</b><br/>
<font size="2">(06:23:47 PM)</font><b> tsenart left the room (quit: Remote host closed the connection).</b><br/>
<font size="2">(06:24:15 PM)</font><b> tsenart [<em>~tsenart@213.61.153.26</em>] entered the room.</b><br/>
<font color="#A82F2F"><font size="2">(06:24:27 PM)</font> <b>tv:</b></font> sure, will take some min. ...<br/>
<font size="2">(06:26:24 PM)</font><b> pmade [<em>~pmade@2601:1:9202:63d0:5604:a6ff:fe1c:ac56</em>] entered the room.</b><br/>
<font color="#A82F2F"><font size="2">(06:27:44 PM)</font> <b>aszlig:</b></font> tv: thanks in advance :-)<br/>
<font color="#A82F2F"><font size="2">(06:28:09 PM)</font> <b>wmertens:</b></font> niksnut: since you&apos;re in the install script subject, what about https://github.com/NixOS/nix/pull/363 ?<br/>
<font size="2">(06:28:41 PM)</font><b> tsenart left the room (quit: Ping timeout: 264 seconds).</b><br/>
<font color="#A82F2F"><font size="2">(06:29:29 PM)</font> <b>niksnut:</b></font> wmertens: I&apos;m not crazy about running verify/optimize in the install script<br/>
<font color="#A82F2F"><font size="2">(06:29:35 PM)</font> <b>niksnut:</b></font> it can take a really long time on large Nix stores<br/>
<font size="2">(06:29:44 PM)</font><b> bennofs left the room (quit: Ping timeout: 250 seconds).</b><br/>
<font size="2">(06:29:45 PM)</font><b> mattdv [<em>~matt@76-201-62-110.lightspeed.irvnca.sbcglobal.net</em>] entered the room.</b><br/>
<font color="#A82F2F"><font size="2">(06:29:57 PM)</font> <b>wmertens:</b></font> niksnut: the thing is, it&apos;s really fast on a fresh install and then you&apos;re sure everything installed correctly<br/>
<font color="#A82F2F"><font size="2">(06:30:15 PM)</font> <b>wmertens:</b></font> niksnut: likewise, when I&apos;m reinstalling nix via that script, it means something is wrong...<br/>
<font color="#A82F2F"><font size="2">(06:30:25 PM)</font> <b>niksnut:</b></font> well, on a fresh install there is nothing to verify or optimize<br/>
<font color="#A82F2F"><font size="2">(06:30:47 PM)</font> <b>niksnut:</b></font> wmertens: not necessarily, you could simply use it as a lazy way to upgrade Nix<br/>
<font color="#A82F2F"><font size="2">(06:30:48 PM)</font> <b>wmertens:</b></font> I spent like 3 hours fixing my nix store after it got zoinked and I didn&apos;t figure out that the db thought everything was still tehre<br/>
<font color="#A82F2F"><font size="2">(06:31:11 PM)</font> <b>wmertens:</b></font> niksnut: I thought I did a fresh install, and it wasn&apos;t<br/>
<font color="#A82F2F"><font size="2">(06:31:14 PM)</font> <b>niksnut:</b></font> wmertens: we could run &quot;nix-store --verify&quot; (without --check-contents)<br/>
<font color="#A82F2F"><font size="2">(06:31:22 PM)</font> <b>niksnut:</b></font> that&apos;s much faster<br/>
<font color="#A82F2F"><font size="2">(06:31:31 PM)</font> <b>niksnut:</b></font> it only checks whether paths exist<br/>
<font color="#062585"><font size="2">(06:31:35 PM)</font> <b>***wmertens</b></font> wonders if that would have helped<br/>
<font color="#A82F2F"><font size="2">(06:32:05 PM)</font> <b>niksnut:</b></font> well, if the paths were gone, it would have noticed<br/>
<font color="#A82F2F"><font size="2">(06:32:40 PM)</font> <b>wmertens:</b></font> niksnut: well I&apos;ll take that then. Let me adjust the patch. Note that those permissions I&apos;m adding, I found because of check-contents. Also, when it runs it adds checksum and size that are missing<br/>
<font color="#A82F2F"><font size="2">(06:34:23 PM)</font> <b>wmertens:</b></font> niksnut: should I squash?<br/>
<font color="#A82F2F"><font size="2">(06:34:30 PM)</font> <b>aaronlevin:</b></font> wmertens: unfortunately, installing curl from that nix closure didn&apos;t seem to help.<br/>
<font color="#A82F2F"><font size="2">(06:34:41 PM)</font> <b>wmertens:</b></font> aaronlevin: try an earlier one then :)<br/>
<font color="#A82F2F"><font size="2">(06:34:55 PM)</font> <b>aaronlevin:</b></font> wmertens: haha. ok. I will. it&apos;s not imperative this works immediately, I can wait a day or two.<br/>
<font color="#A82F2F"><font size="2">(06:34:56 PM)</font> <b>wmertens:</b></font> aaronlevin: you don&apos;t have any previous system profiles?<br/>
<font color="#A82F2F"><font size="2">(06:35:10 PM)</font> <b>aaronlevin:</b></font> wmertens: no, this is all happening within a docker container.<br/>
<font size="2">(06:35:23 PM)</font><b> Takle [<em>~takle@2a00:fd00:fff1:5768:4d2d:4bef:9ee5:dcd4</em>] entered the room.</b><br/>
<font size="2">(06:36:38 PM)</font><b> Takle left the room (quit: Remote host closed the connection).</b><br/>
<font size="2">(06:37:14 PM)</font><b> Takle [<em>~takle@2a00:fd00:fff1:5768:4d2d:4bef:9ee5:dcd4</em>] entered the room.</b><br/>
<font color="#A82F2F"><font size="2">(06:37:51 PM)</font> <b>NixOS_GitHub:</b></font> (notice) [nixpkgs] peti pushed 1 new commit to master: http://git.io/7skYEw<br/>
<font color="#A82F2F"><font size="2">(06:37:52 PM)</font> <b>NixOS_GitHub:</b></font> (notice) nixpkgs/master fa165e1 Peter Simons: cabal-install: update to version 1.20.0.4...<br/>
<font size="2">(06:39:27 PM)</font><b> mizu_no_oto [<em>~textual@gw1.mcgraw-hill.com</em>] entered the room.</b><br/>
<font size="2">(06:39:47 PM)</font><b> devoid [<em>~Adium@24-136-27-88.c3-0.lem-ubr2.chi-lem.il.cable.rcn.com</em>] entered the room.</b><br/>
<font color="#A82F2F"><font size="2">(06:39:58 PM)</font> <b>wmertens:</b></font> niksnut: https://github.com/NixOS/nix/pull/363/files better?<br/>
<font size="2">(06:41:17 PM)</font><b> Lowl3v3l [<em>~Lowl3v3l@2a02:810a:8380:92c:3130:6c07:d856:205b</em>] entered the room.</b><br/>
<font size="2">(06:41:52 PM)</font><b> Takle left the room (quit: Ping timeout: 258 seconds).</b><br/>
<font color="#A82F2F"><font size="2">(06:43:46 PM)</font> <b>shlevy:</b></font> OK testing a build of systemd with my patch<br/>
<font size="2">(06:44:17 PM)</font><b> ambro718 [<em>~ambro@gentoo/contributor/ambro718</em>] entered the room.</b><br/>
<font color="#A82F2F"><font size="2">(06:58:18 PM)</font> <b>Lethalman:</b></font> wmertens, why /bin/sh ?<br/>
<font size="2">(06:58:40 PM)</font><b> peacememories [<em>~peace@2001:858:5:3a40:6afe:69c0:6646:f749</em>] entered the room.</b><br/>
<font color="#A82F2F"><font size="2">(06:58:42 PM)</font> <b>wmertens:</b></font> that always exists and bash is not always installed<br/>
<font color="#062585"><font size="2">(06:58:44 PM)</font> <b>***Lethalman</b></font> is always afraid of /bin/sh<br/>
<font color="#A82F2F"><font size="2">(06:59:00 PM)</font> <b>wmertens:</b></font> I checked, the whole script is POSIX compliant<br/>
<font color="#A82F2F"><font size="2">(06:59:08 PM)</font> <b>ambro718:</b></font> So I advise some guy to use Nix to compile my software, and 3 days later he comes back, having created his first blog for the sole purpose of posting a rant on NixOS, lol, https://dave1999.wordpress.com/<br/>
<font color="#A82F2F"><font size="2">(06:59:10 PM)</font> <b>Lethalman:</b></font> good<br/>
<font size="2">(06:59:12 PM)</font><b> peacememories left the room (quit: Client Quit).</b><br/>
<font color="#A82F2F"><font size="2">(07:00:10 PM)</font> <b>shlevy:</b></font> &quot;Ironically, that would not have been an issue if I could have installed the Nix package manager with Nix &quot; &lt;- you can do that :P<br/>
<font color="#A82F2F"><font size="2">(07:00:32 PM)</font> <b>wmertens:</b></font> ambro718: next time tell him to install with the nix install instructions<br/>
<font color="#A82F2F"><font size="2">(07:00:48 PM)</font> <b>Lethalman:</b></font> ahahah<br/>
<font size="2">(07:00:51 PM)</font><b> peacememories [<em>~peace@2001:858:5:3a40:6afe:69c0:6646:f749</em>] entered the room.</b><br/>
<font size="2">(07:00:51 PM)</font><b> peacememories left the room (quit: Read error: error:1408F10B:SSL routines:SSL3_GET_RECORD:wrong version number).</b><br/>
<font color="#A82F2F"><font size="2">(07:00:58 PM)</font> <b>ambro718:</b></font> wmertens: I have: &quot;Install Nix as described at http://nixos.org/nix/ .&quot;<br/>
<font color="#A82F2F"><font size="2">(07:01:07 PM)</font> <b>Lethalman:</b></font> well guys<br/>
<font color="#A82F2F"><font size="2">(07:01:08 PM)</font> <b>Lethalman:</b></font> anyway<br/>
<font color="#A82F2F"><font size="2">(07:01:18 PM)</font> <b>ambro718:</b></font> I think that should have been enough, since there&apos;s a nice &quot;Install Nix&quot; button with code you paste into the shell<br/>
<font color="#A82F2F"><font size="2">(07:01:20 PM)</font> <b>Lethalman:</b></font> nixos is not at the point of telling people: just use nixos instead of X<br/>
<font color="#A82F2F"><font size="2">(07:01:25 PM)</font> <b>Lethalman:</b></font> to any person<br/>
<font color="#A82F2F"><font size="2">(07:01:39 PM)</font> <b>wmertens:</b></font> ambro718: true. I guess he wanted to do it cleanly with the packages<br/>
<font color="#A82F2F"><font size="2">(07:01:51 PM)</font> <b>ambro718:</b></font> well he made his life harder by choice...<br/>
<font color="#A82F2F"><font size="2">(07:01:52 PM)</font> <b>Lethalman:</b></font> it&apos;s just backfire<br/>
<font color="#A82F2F"><font size="2">(07:02:01 PM)</font> <b>shlevy:</b></font> Yeesh<br/>
<font color="#A82F2F"><font size="2">(07:02:30 PM)</font> <b>shlevy:</b></font> Maybe the default MOTD should say &quot;NixOS is really different from most Linux distros, *please* RTFM!&quot;<br/>
<font color="#062585"><font size="2">(07:02:37 PM)</font> <b>***Lethalman</b></font> never suggests people to use nix, in fact... just telling its existance<br/>
<font color="#A82F2F"><font size="2">(07:03:07 PM)</font> <b>Lethalman:</b></font> shlevy, rtfm is not enough, I think nix is only for people that are really looking for nix, and not for an ordinal OS<br/>
<font color="#A82F2F"><font size="2">(07:03:20 PM)</font> <b>wmertens:</b></font> ouch: download-from-binary-cache.pl: binary cache ‘http://hydra.nixos.org’ is not trusted<br/>
<font color="#A82F2F"><font size="2">(07:03:28 PM)</font> <b>Lethalman:</b></font> wmertens, http -&gt; https<br/>
<font color="#A82F2F"><font size="2">(07:03:49 PM)</font> <b>Lethalman:</b></font> bb<br/>
<font color="#A82F2F"><font size="2">(07:04:41 PM)</font> <b>NixOS_GitHub:</b></font> (notice) [nixpkgs] peti pushed 2 new commits to master: http://git.io/JTWtPw<br/>
<font color="#A82F2F"><font size="2">(07:04:41 PM)</font> <b>NixOS_GitHub:</b></font> (notice) nixpkgs/master c9cd0bc Peter Simons: ghc-head: fix configure phase to make sure the compiler knows how to use gmp properly...<br/>
<font color="#A82F2F"><font size="2">(07:04:41 PM)</font> <b>NixOS_GitHub:</b></font> (notice) nixpkgs/master f958089 Peter Simons: ghc-head: bump version to most recent snapshot<br/>
<font color="#A82F2F"><font size="2">(07:05:23 PM)</font> <b>wmertens:</b></font> awww no commentws<br/>
<font size="2">(07:05:53 PM)</font><b> Lethalman left the room (quit: Quit: Sto andando via).</b><br/>
<font color="#A82F2F"><font size="2">(07:06:30 PM)</font> <b>wmertens:</b></font> alright so to sum up, the packages should have 0 dependencies, and the virtualbox vm should have a fixed cache url<br/>
<font color="#A82F2F"><font size="2">(07:07:59 PM)</font> <b>iElectric:</b></font> http://torrentfreak.com/bittorrent-anonymous-and-impossible-to-shut-down-141218/<br/>
<font color="#A82F2F"><font size="2">(07:08:50 PM)</font> <b>iElectric:</b></font> didn&apos;t that reside on hydra once? :D<br/>
<font size="2">(07:09:10 PM)</font><b> rost left the room (quit: Ping timeout: 250 seconds).</b><br/>
<font size="2">(07:09:18 PM)</font><b> _deepfire left the room (quit: Ping timeout: 256 seconds).</b><br/>
<font color="#A82F2F"><font size="2">(07:12:49 PM)</font> <b>Fuuzetsu:</b></font> is that packaged<br/>
<font size="2">(07:12:54 PM)</font><b> Takle [<em>~takle@2a00:fd00:fff1:5768:f1db:a44c:8283:f089</em>] entered the room.</b><br/>
<font color="#A82F2F"><font size="2">(07:13:20 PM)</font> <b>NixOS_GitHub:</b></font> (notice) [nixpkgs] vcunat pushed 2 new commits to release-14.12: http://git.io/3fWvaQ<br/>
<font color="#A82F2F"><font size="2">(07:13:20 PM)</font> <b>NixOS_GitHub:</b></font> (notice) nixpkgs/release-14.12 9ec8d3e Sebastián Bernardo Galkin: xorg-server: enable DRI3 (close #5381)...<br/>
<font color="#A82F2F"><font size="2">(07:13:20 PM)</font> <b>NixOS_GitHub:</b></font> (notice) nixpkgs/release-14.12 3865ab9 Vladimír Čunát: nixos/doc release notes: mention intel GPU driver<br/>
<font size="2">(07:16:03 PM)</font><b> bennofs [<em>~benno@ip92342b4f.dynamic.kabel-deutschland.de</em>] entered the room.</b><br/>
<font size="2">(07:19:27 PM)</font><b> skiold left the room (quit: Quit: WeeChat 0.4.3).</b><br/>
<font size="2">(07:22:23 PM)</font><b> rost [<em>~robert@e177023245.adsl.alicedsl.de</em>] entered the room.</b><br/>
<font color="#A82F2F"><font size="2">(07:23:41 PM)</font> <b>iElectric:</b></font> postgresql 9.4 released http://www.postgresql.org/about/news/1557/<br/>
<font color="#A82F2F"><font size="2">(07:24:05 PM)</font> <b>iElectric:</b></font> With the new JSONB data type for PostgreSQL, users no longer have to choose between relational and non-relational data stores: they can have both at the same time. JSONB supports fast lookups and simple expression search queries using Generalized Inverted Indexes (GIN).<br/>
<font color="#A82F2F"><font size="2">(07:24:08 PM)</font> <b>iElectric:</b></font> niceee<br/>
<font size="2">(07:24:37 PM)</font><b> _deepfire [<em>~chatzilla@31.44.93.25</em>] entered the room.</b><br/>
<font color="#A82F2F"><font size="2">(07:26:39 PM)</font> <b>aristid:</b></font> iElectric: we have an expression for beta3, should be easy to adapt to the final:)<br/>
<font size="2">(07:29:29 PM)</font><b> devoid left the room (quit: Quit: Leaving.).</b><br/>
<font size="2">(07:34:48 PM)</font><b> Takle left the room (quit: Remote host closed the connection).</b><br/>
<font size="2">(07:35:28 PM)</font><b> sogatori [<em>~quassel@dslb-088-067-040-254.088.067.pools.vodafone-ip.de</em>] entered the room.</b><br/>
<font size="2">(07:40:58 PM)</font><b> devoid [<em>~Adium@24-136-27-88.c3-0.lem-ubr2.chi-lem.il.cable.rcn.com</em>] entered the room.</b><br/>
<font size="2">(07:45:14 PM)</font><b> joachifm [<em>~joachifm@209.222.18.51</em>] entered the room.</b><br/>
<font size="2">(07:46:27 PM)</font><b> keeds [<em>~keeds@88-97-1-216.dsl.zen.co.uk</em>] entered the room.</b><br/>
<font size="2">(07:59:54 PM)</font><b> hexagoxel left the room (quit: Ping timeout: 264 seconds).</b><br/>
<font color="#A82F2F"><font size="2">(08:05:32 PM)</font> <b>iElectric:</b></font> I&apos;m getting 100% CPU usage on my host from VBoxHeadless while my guest OS (ubuntu) is idling<br/>
<font color="#A82F2F"><font size="2">(08:05:41 PM)</font> <b>iElectric:</b></font> if someone has an idea, shoot it out please :-)<br/>
<font size="2">(08:06:26 PM)</font><b> MichaelRaskin [<em>~MichaelRa@195.91.224.161</em>] entered the room.</b><br/>
<font color="#A82F2F"><font size="2">(08:07:10 PM)</font> <b>NixOS_GitHub:</b></font> (notice) [nixpkgs] valeriangalliat opened pull request #5389: opensmtpd: fix homepage URL (master...opensmtpd-homepage) http://git.io/qJsekw<br/>
<font size="2">(08:24:22 PM)</font><b> The account has disconnected and you are no longer in this chat. You will automatically rejoin the chat when the account reconnects.</b><br/>
</body></html>
