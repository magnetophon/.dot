<html><head><meta http-equiv="content-type" content="text/html; charset=UTF-8"><title>Conversation with henrytill at Sat 22 Nov 2014 10:57:11 PM CET on magnetophon@irc.freenode.net (irc)</title></head><body><h3>Conversation with henrytill at Sat 22 Nov 2014 10:57:11 PM CET on magnetophon@irc.freenode.net (irc)</h3>
<font color="#A82F2F"><font size="2">(10:57:11 PM)</font> <b>henrytill:</b></font> no problem<br/>
<font color="#A82F2F"><font size="2">(10:57:22 PM)</font> <b>henrytill:</b></font> feel free to drop me an email: henrytill@gmail.com<br/>
<font color="#16569E"><font size="2">(10:57:41 PM)</font> <b>magnetophon:</b></font> thanks<br/>
<font color="#16569E"><font size="2">(10:57:59 PM)</font> <b>magnetophon:</b></font> was jij nou nederlander of niet?<br/>
<font color="#A82F2F"><font size="2">(10:58:04 PM)</font> <b>henrytill:</b></font> i&apos;m looking forward to giving this a whirl<br/>
<font color="#A82F2F"><font size="2">(10:58:18 PM)</font> <b>henrytill:</b></font> no, i&apos;m american<br/>
<font color="#16569E"><font size="2">(10:58:35 PM)</font> <b>magnetophon:</b></font> but you got my question :)<br/>
<font color="#A82F2F"><font size="2">(10:58:43 PM)</font> <b>henrytill:</b></font> and i have loads of respect for your country<br/>
<font color="#16569E"><font size="2">(10:59:09 PM)</font> <b>magnetophon:</b></font> I can really reccomend faust if you are into audio and functional programming. It really is the bees knees!!!<br/>
<font color="#A82F2F"><font size="2">(10:59:22 PM)</font> <b>henrytill:</b></font> excellent<br/>
<font color="#A82F2F"><font size="2">(10:59:22 PM)</font> <b>henrytill:</b></font> well<br/>
<font color="#A82F2F"><font size="2">(10:59:25 PM)</font> <b>henrytill:</b></font> welterusten<br/>
<font color="#16569E"><font size="2">(10:59:30 PM)</font> <b>magnetophon:</b></font> :)<br/>
<font color="#16569E"><font size="2">(10:59:41 PM)</font> <b>magnetophon:</b></font> good night!<br/>
<font color="#A82F2F"><font size="2">(12:01:37 AM)</font> <b>henrytill:</b></font> shall we take this out of the chaosphere?<br/>
<font color="#16569E"><font size="2">(12:04:01 AM)</font> <b>magnetophon:</b></font> we could, but then noone can join... Not sure what the proper irctiquette is...<br/>
<font color="#16569E"><font size="2">(12:04:19 AM)</font> <b>magnetophon:</b></font> bu let's<br/>
<font color="#16569E"><font size="2">(12:04:22 AM)</font> <b>magnetophon:</b></font> but<br/>
<font color="#A82F2F"><font size="2">(12:06:04 AM)</font> <b>henrytill:</b></font> clearly this tools/faust2appls/faustpath plays into this<br/>
<font color="#A82F2F"><font size="2">(12:07:22 AM)</font> <b>henrytill:</b></font> namely this $FAUST_INSTALL variable<br/>
<font color="#16569E"><font size="2">(12:07:54 AM)</font> <b>magnetophon:</b></font> faustpath is a utility that tells the makefile where to install faust, right?<br/>
<font color="#A82F2F"><font size="2">(12:08:37 AM)</font> <b>henrytill:</b></font> not exactly<br/>
<font color="#A82F2F"><font size="2">(12:08:53 AM)</font> <b>henrytill:</b></font> it tells all the faust2 stuff where faust and its libs are<br/>
<font color="#A82F2F"><font size="2">(12:09:07 AM)</font> <b>henrytill:</b></font> as far as i can tell<br/>
<font color="#A82F2F"><font size="2">(12:10:08 AM)</font> <b>henrytill:</b></font> so are you familiar with nix-shell yet?<br/>
<font color="#16569E"><font size="2">(12:10:25 AM)</font> <b>magnetophon:</b></font> not at all<br/>
<font color="#A82F2F"><font size="2">(12:10:43 AM)</font> <b>henrytill:</b></font> nix-shell sets you up with a shell inside of the build environment<br/>
<font color="#16569E"><font size="2">(12:10:44 AM)</font> <b>magnetophon:</b></font> i started reading up on it but then irc got active<br/>
<font color="#A82F2F"><font size="2">(12:11:00 AM)</font> <b>henrytill:</b></font> so in this case we would nix-shell -f &apos;&lt;nixpkgs&gt;&apos; -A faust<br/>
<font color="#A82F2F"><font size="2">(12:11:32 AM)</font> <b>henrytill:</b></font> excuse me, no &quot;-f&quot;<br/>
<font color="#A82F2F"><font size="2">(12:11:40 AM)</font> <b>henrytill:</b></font> just nix-shell &apos;&lt;nixpkgs&gt;&apos; -A faust<br/>
<font color="#A82F2F"><font size="2">(12:12:06 AM)</font> <b>henrytill:</b></font> so invoked that inside my $HOME/tmp directory<br/>
<font color="#16569E"><font size="2">(12:12:12 AM)</font> <b>magnetophon:</b></font> error: attribute `faust' in selection path `faust' not found<br/>
<font color="#A82F2F"><font size="2">(12:12:25 AM)</font> <b>henrytill:</b></font> ah yes<br/>
<font color="#A82F2F"><font size="2">(12:12:49 AM)</font> <b>henrytill:</b></font> so remember that packageOverride stuff i showed you earlier today?<br/>
<font color="#16569E"><font size="2">(12:12:53 AM)</font> <b>magnetophon:</b></font> yes<br/>
<font color="#A82F2F"><font size="2">(12:13:23 AM)</font> <b>henrytill:</b></font> you put that... { packageOverrides... } in ~/.nixpkgs/config.nix<br/>
<font color="#16569E"><font size="2">(12:13:38 AM)</font> <b>magnetophon:</b></font> ok<br/>
<font color="#A82F2F"><font size="2">(12:13:46 AM)</font> <b>henrytill:</b></font> the stuff we did earlier only applies to nixos-rebuild<br/>
<font color="#16569E"><font size="2">(12:13:58 AM)</font> <b>magnetophon:</b></font> right<br/>
<font color="#A82F2F"><font size="2">(12:14:00 AM)</font> <b>henrytill:</b></font> ~/.nixpkgs/config.nix applies to nix-env and nix-shell<br/>
<font color="#16569E"><font size="2">(12:16:35 AM)</font> <b>magnetophon:</b></font> error: syntax error, unexpected '=', expecting $end, at /home/bart/.nixpkgs/config.nix:1:33<br/>
<font color="#16569E"><font size="2">(12:16:48 AM)</font> <b>magnetophon:</b></font> when i run your nix-shell command<br/>
<font color="#A82F2F"><font size="2">(12:16:57 AM)</font> <b>henrytill:</b></font> wild!<br/>
<font color="#A82F2F"><font size="2">(12:17:06 AM)</font> <b>henrytill:</b></font> lemme see config.nix<br/>
<font color="#16569E"><font size="2">(12:17:26 AM)</font> <b>magnetophon:</b></font> nixpkgs.config.packageOverrides = pkgs: { faust = pkgs.callPackage /home/bart/source/nixpkgs/pkgs/applications/audio/faust/default.nix { }; };<br/>
<font color="#16569E"><font size="2">(12:17:34 AM)</font> <b>magnetophon:</b></font> that's all<br/>
<font color="#A82F2F"><font size="2">(12:17:59 AM)</font> <b>henrytill:</b></font> oh okay<br/>
<font color="#A82F2F"><font size="2">(12:18:14 AM)</font> <b>henrytill:</b></font> so delete &quot;nixpkgs.config.&quot;<br/>
<font color="#A82F2F"><font size="2">(12:18:39 AM)</font> <b>henrytill:</b></font> and wrap the whole thing in in { }<br/>
<font color="#A82F2F"><font size="2">(12:18:50 AM)</font> <b>henrytill:</b></font> no semicolon at the end<br/>
<font color="#16569E"><font size="2">(12:20:08 AM)</font> <b>magnetophon:</b></font> OK, now i just need to comment out the licence and maintainer. one sec<br/>
<font color="#A82F2F"><font size="2">(12:20:18 AM)</font> <b>henrytill:</b></font> yepyep<br/>
<font color="#16569E"><font size="2">(12:21:12 AM)</font> <b>magnetophon:</b></font> ok, now what?<br/>
<font color="#16569E"><font size="2">(12:21:17 AM)</font> <b>magnetophon:</b></font> :)<br/>
<font color="#A82F2F"><font size="2">(12:21:43 AM)</font> <b>henrytill:</b></font> so go to a directory where you don&apos;t mind having temporary stuff<br/>
<font color="#A82F2F"><font size="2">(12:21:49 AM)</font> <b>henrytill:</b></font> i.e. ~/tmp or the like<br/>
<font color="#A82F2F"><font size="2">(12:22:03 AM)</font> <b>henrytill:</b></font> nix-shell &apos;&lt;nixpkgs&gt;&apos; -A faust<br/>
<font color="#16569E"><font size="2">(12:22:44 AM)</font> <b>magnetophon:</b></font> OK, first i need to get out of the current nix-shell<br/>
<font color="#A82F2F"><font size="2">(12:22:54 AM)</font> <b>henrytill:</b></font> yep just C-d<br/>
<font color="#16569E"><font size="2">(12:23:18 AM)</font> <b>magnetophon:</b></font> ok, I'm in<br/>
<font color="#A82F2F"><font size="2">(12:23:33 AM)</font> <b>henrytill:</b></font> so first you type &apos;unpackPhase&apos;<br/>
<font color="#A82F2F"><font size="2">(12:24:09 AM)</font> <b>henrytill:</b></font> then cd into the faust directory<br/>
<font color="#16569E"><font size="2">(12:24:28 AM)</font> <b>magnetophon:</b></font> ok<br/>
<font color="#A82F2F"><font size="2">(12:24:57 AM)</font> <b>henrytill:</b></font> then you can type buildPhase<br/>
<font color="#A82F2F"><font size="2">(12:25:04 AM)</font> <b>henrytill:</b></font> and it should start compiling<br/>
<font color="#16569E"><font size="2">(12:25:29 AM)</font> <b>magnetophon:</b></font> yup<br/>
<font color="#A82F2F"><font size="2">(12:26:00 AM)</font> <b>henrytill:</b></font> so here you&apos;re in the same environment that it compiles in<br/>
<font color="#A82F2F"><font size="2">(12:26:09 AM)</font> <b>henrytill:</b></font> and you have all the same tools at your disposal<br/>
<font color="#16569E"><font size="2">(12:26:13 AM)</font> <b>magnetophon:</b></font> right<br/>
<font color="#A82F2F"><font size="2">(12:26:22 AM)</font> <b>henrytill:</b></font> and you can echo the value of variables and whatnot<br/>
<font color="#A82F2F"><font size="2">(12:26:31 AM)</font> <b>henrytill:</b></font> so it&apos;s helpful for debugging builds<br/>
<font color="#16569E"><font size="2">(12:26:38 AM)</font> <b>magnetophon:</b></font> sure is<br/>
<font color="#16569E"><font size="2">(12:26:47 AM)</font> <b>magnetophon:</b></font> thanks<br/>
<font color="#A82F2F"><font size="2">(12:26:52 AM)</font> <b>henrytill:</b></font> after i did buildPhase, i did &quot;echo $FAUST_INSTALL&quot;<br/>
<font color="#A82F2F"><font size="2">(12:27:10 AM)</font> <b>henrytill:</b></font> found it wasn&apos;t set<br/>
<font color="#A82F2F"><font size="2">(12:27:42 AM)</font> <b>henrytill:</b></font> so now i&apos;m seeing if adding that to script will get us beyond this<br/>
<font color="#16569E"><font size="2">(12:28:06 AM)</font> <b>magnetophon:</b></font> right<br/>
<font color="#A82F2F"><font size="2">(12:28:38 AM)</font> <b>henrytill:</b></font> if not we can patch that file<br/>
<font color="#A82F2F"><font size="2">(12:28:53 AM)</font> <b>henrytill:</b></font> which will probably propogate to the other files<br/>
<font color="#16569E"><font size="2">(12:30:32 AM)</font> <b>magnetophon:</b></font> slightly related: you seem to have a command called error on your system, can you confirm that?<br/>
<font color="#A82F2F"><font size="2">(12:31:02 AM)</font> <b>henrytill:</b></font> command not found<br/>
<font color="#16569E"><font size="2">(12:32:32 AM)</font> <b>magnetophon:</b></font> ah, right, faust2jack uses that command (to tell the user about the missing path we are discussing), and faust2alsa doesn't, if I recall correctly<br/>
<font color="#A82F2F"><font size="2">(12:34:09 AM)</font> <b>henrytill:</b></font> oh yes<br/>
<font color="#A82F2F"><font size="2">(12:34:12 AM)</font> <b>henrytill:</b></font> now i see<br/>
<font color="#A82F2F"><font size="2">(12:35:42 AM)</font> <b>henrytill:</b></font> also different fscking variables for the library path in those two<br/>
<font color="#16569E"><font size="2">(12:35:58 AM)</font> <b>magnetophon:</b></font> huh?<br/>
<font color="#A82F2F"><font size="2">(12:36:15 AM)</font> <b>henrytill:</b></font> faust2jack uses FAUST_LIB_PATH<br/>
<font color="#A82F2F"><font size="2">(12:37:01 AM)</font> <b>henrytill:</b></font> faustpath uses &quot;FAUSTLIB&quot;<br/>
<font color="#16569E"><font size="2">(12:38:41 AM)</font> <b>magnetophon:</b></font> did you see this comment in faustpath:<br/>
<font color="#16569E"><font size="2">(12:38:43 AM)</font> <b>magnetophon:</b></font> # Search where Faust is installed. Store '.../lib/faust/' in $FAUSTLIB<br/>
<font color="#16569E"><font size="2">(12:38:43 AM)</font> <b>magnetophon:</b></font> # and '.../include/(faust)' in $FAUSTINC <br/>
<font color="#A82F2F"><font size="2">(12:40:04 AM)</font> <b>henrytill:</b></font> these scripts seem a lil messy<br/>
<font color="#A82F2F"><font size="2">(12:40:20 AM)</font> <b>henrytill:</b></font> like where and how was FAUST_INSTALL supposed to get set?<br/>
<font color="#A82F2F"><font size="2">(12:40:30 AM)</font> <b>henrytill:</b></font> and what about cases where the prefix isn&apos;t the ones lsited<br/>
<font color="#16569E"><font size="2">(12:41:21 AM)</font> <b>magnetophon:</b></font> could be done better. I'll take a look at the current git version of they improved that yet.<br/>
<font color="#A82F2F"><font size="2">(12:42:26 AM)</font> <b>henrytill:</b></font> so one example for postInstall:<br/>
<font color="#A82F2F"><font size="2">(12:42:35 AM)</font> <b>henrytill:</b></font> substituteInPlace tools/faust2appls/faustpath \ --replace=&quot;/usr/local /usr /opt /opt/local&quot; $out<br/>
<font color="#A82F2F"><font size="2">(12:42:53 AM)</font> <b>henrytill:</b></font> substituteInPlace tools/faust2appls/faustpath  --replace=&quot;/usr/local /usr /opt /opt/local&quot; $out<br/>
<font color="#A82F2F"><font size="2">(12:43:08 AM)</font> <b>henrytill:</b></font> the backslash would be if you split it along lines of course<br/>
<font color="#A82F2F"><font size="2">(12:44:05 AM)</font> <b>henrytill:</b></font> does any of this help?<br/>
<font color="#16569E"><font size="2">(12:46:16 AM)</font> <b>magnetophon:</b></font> buildPhase sais: Nothing to be done for `all'<br/>
<font color="#A82F2F"><font size="2">(12:46:45 AM)</font> <b>henrytill:</b></font> shouldn&apos;t be a problem<br/>
<font color="#A82F2F"><font size="2">(12:47:35 AM)</font> <b>henrytill:</b></font> the point of using a nix-shell in this context isn&apos;t to get a finished product<br/>
<font color="#A82F2F"><font size="2">(12:47:50 AM)</font> <b>henrytill:</b></font> it&apos;s more for testing the process<br/>
<font color="#A82F2F"><font size="2">(12:48:08 AM)</font> <b>henrytill:</b></font> there is also a configurePhase, patchPhase, etc<br/>
<font color="#16569E"><font size="2">(12:48:11 AM)</font> <b>magnetophon:</b></font> it's also normal I cannot do installPhase from there, right<br/>
<font color="#A82F2F"><font size="2">(12:48:15 AM)</font> <b>henrytill:</b></font> yes<br/>
<font color="#A82F2F"><font size="2">(12:48:45 AM)</font> <b>henrytill:</b></font> so we can&apos;t test postInstall from the nix-shell<br/>
<font color="#16569E"><font size="2">(12:48:59 AM)</font> <b>magnetophon:</b></font> so now I install from the normal terminal?<br/>
<font color="#A82F2F"><font size="2">(12:49:31 AM)</font> <b>henrytill:</b></font> you could patch those files in the preBuild phase and then check that they were successfully patched<br/>
<font color="#A82F2F"><font size="2">(12:49:38 AM)</font> <b>henrytill:</b></font> or better yet postUnpack<br/>
<font color="#A82F2F"><font size="2">(12:50:09 AM)</font> <b>henrytill:</b></font> so use postUnpack = &apos;&apos; .... &apos;&apos;; instead of preBuild = &apos;&apos; ... &apos;&apos;;<br/>
<font color="#A82F2F"><font size="2">(12:50:41 AM)</font> <b>henrytill:</b></font> and then when you type unpackPhase, it would execute that set of commands and you could check the result<br/>
<font color="#16569E"><font size="2">(12:50:45 AM)</font> <b>magnetophon:</b></font> how do you decide wether to use patchphase or one of those you mentioned?<br/>
<font color="#A82F2F"><font size="2">(12:51:32 AM)</font> <b>henrytill:</b></font> patchPhase is really better suited if you actually apply separate .patch files or use the patch=&quot;&lt;command&gt;&quot; command<br/>
<font color="#A82F2F"><font size="2">(12:51:56 AM)</font> <b>henrytill:</b></font> postUnpack and preBuild are pretty common<br/>
<font color="#16569E"><font size="2">(12:52:10 AM)</font> <b>magnetophon:</b></font> for the final result that doesn't matter, right? more a matter of style, consistency and readability iiuc<br/>
<font color="#A82F2F"><font size="2">(12:52:41 AM)</font> <b>henrytill:</b></font> well it does in cases where you might have a configurePhase in between unpack and build<br/>
<font color="#16569E"><font size="2">(12:52:48 AM)</font> <b>magnetophon:</b></font> not implying those aren't important, just trying to learn<br/>
<font color="#16569E"><font size="2">(12:53:03 AM)</font> <b>magnetophon:</b></font> right<br/>
<font color="#16569E"><font size="2">(12:53:27 AM)</font> <b>magnetophon:</b></font> ok, I've got some work to do and will report back when done<br/>
<font color="#A82F2F"><font size="2">(12:53:28 AM)</font> <b>henrytill:</b></font> http://nixos.org/nixpkgs/manual/<br/>
<font color="#A82F2F"><font size="2">(12:53:38 AM)</font> <b>henrytill:</b></font> all the phases are covered there<br/>
<font color="#16569E"><font size="2">(12:54:06 AM)</font> <b>magnetophon:</b></font> hey, I DID tell you I started reading and wanted to finnish ;)<br/>
<font color="#A82F2F"><font size="2">(12:54:15 AM)</font> <b>henrytill:</b></font> yep yep<br/>
<font color="#A82F2F"><font size="2">(12:54:20 AM)</font> <b>henrytill:</b></font> :D<br/>
<font color="#16569E"><font size="2">(12:54:26 AM)</font> <b>magnetophon:</b></font> cool thanks!<br/>
<font color="#A82F2F"><font size="2">(12:54:37 AM)</font> <b>henrytill:</b></font> happy to lend a hand<br/>
<font color="#A82F2F"><font size="2">(12:55:11 AM)</font> <b>henrytill:</b></font> not the easiest first package...<br/>
<font color="#A82F2F"><font size="2">(12:55:32 AM)</font> <b>henrytill:</b></font> alright i&apos;m out for real now<br/>
<font color="#A82F2F"><font size="2">(12:55:35 AM)</font> <b>henrytill:</b></font> gotta eat<br/>
<font color="#16569E"><font size="2">(12:55:42 AM)</font> <b>magnetophon:</b></font> enjoy!<br/>
<font color="#A82F2F"><font size="2">(12:55:55 AM)</font> <b>henrytill:</b></font> thanks, ttyl<br/>
